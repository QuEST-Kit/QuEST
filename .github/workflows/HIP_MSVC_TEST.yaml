name: HIP Windows compile



on:
  push:
    branches:
      - amd-patch
  pull_request:
    branches:
      - amd-patch


jobs:
  build:
    runs-on: windows-latest
    env:
      direc: "C:/workdirec"

    steps:

      - name: view drives
        run: Get-PSDrive

      - run: mkdir ${{ env.direc }}
      - run: cd ${{ env.direc }}

      - name: Download AMD HIP Compiler
        run: Invoke-WebRequest -Uri "https://download.amd.com/developer/eula/rocm-hub/AMD-Software-PRO-Edition-24.Q4-WinSvr2022-For-HIP.exe" -OutFile "install.exe"
        shell: pwsh
        working-directory: ${{ env.direc }}

      - run: Get-ChildItem ${{ env.direc }}
        shell: pwsh

      - name: Install AMD HIP Compiler
        run: Start-Process install.exe -NoNewWindow -Wait
        shell: pwsh
        working-directory: ${{ env.direc }}
