<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Distributed QUEST: qubits.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Distributed QUEST
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_68277f4af6bc8ed0d011317c0e2529fa.html">annabrown</a></li><li class="navelem"><a class="el" href="dir_6e3c536c1787c3a45e4145de2c2bc19a.html">Documents</a></li><li class="navelem"><a class="el" href="dir_37cf7b529a23e53741d276af30e555e2.html">no_sync</a></li><li class="navelem"><a class="el" href="dir_29c23875d7b345797732dae846667030.html">git_qubitNew</a></li><li class="navelem"><a class="el" href="dir_4fbc77c16ae3e84d1f63af1e3244576e.html">QUEST</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">qubits.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The core of the QUEST Library.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &quot;<a class="el" href="precision_8h_source.html">precision.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="qubits_8h_source.html">qubits.h</a>&quot;</code><br />
<code>#include &lt;omp.h&gt;</code><br />
</div>
<p><a href="qubits_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad72dbcf6d0153db1b8d8a58001feed83"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ad72dbcf6d0153db1b8d8a58001feed83"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a100463f6ec212c76a5fad99579000505"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (const int locationOfBitFromRight, const long long int theEncodedNumber)</td></tr>
<tr class="memdesc:a100463f6ec212c76a5fad99579000505"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the value of the bit at a particular index in a number.  <a href="#a100463f6ec212c76a5fad99579000505">More...</a><br /></td></tr>
<tr class="separator:a100463f6ec212c76a5fad99579000505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae729f311efd2a426ce5161df3e017a16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ae729f311efd2a426ce5161df3e017a16">createMultiQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit, int numQubits, <a class="el" href="structQUESTEnv.html">QUESTEnv</a> env)</td></tr>
<tr class="memdesc:ae729f311efd2a426ce5161df3e017a16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits. ">MultiQubit</a> object representing a set of qubits.  <a href="#ae729f311efd2a426ce5161df3e017a16">More...</a><br /></td></tr>
<tr class="separator:ae729f311efd2a426ce5161df3e017a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab796aea79288b974f63474db650be878"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ab796aea79288b974f63474db650be878">destroyMultiQubit</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, <a class="el" href="structQUESTEnv.html">QUESTEnv</a> env)</td></tr>
<tr class="memdesc:ab796aea79288b974f63474db650be878"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits. ">MultiQubit</a> object representing a set of qubits Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version.  <a href="#ab796aea79288b974f63474db650be878">More...</a><br /></td></tr>
<tr class="separator:ab796aea79288b974f63474db650be878"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96f4de9ce7fefc7680a44d601fc3d894"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a96f4de9ce7fefc7680a44d601fc3d894">reportState</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr class="memdesc:a96f4de9ce7fefc7680a44d601fc3d894"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to file.  <a href="#a96f4de9ce7fefc7680a44d601fc3d894">More...</a><br /></td></tr>
<tr class="separator:a96f4de9ce7fefc7680a44d601fc3d894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe2c2118c4311ed5d641d3fd83186be8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#afe2c2118c4311ed5d641d3fd83186be8">reportStateToScreen</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, <a class="el" href="structQUESTEnv.html">QUESTEnv</a> env)</td></tr>
<tr class="memdesc:afe2c2118c4311ed5d641d3fd83186be8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to standard out.  <a href="#afe2c2118c4311ed5d641d3fd83186be8">More...</a><br /></td></tr>
<tr class="separator:afe2c2118c4311ed5d641d3fd83186be8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e77e0e64f3a4a3d3f5cc7382bffcd9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#aa5e77e0e64f3a4a3d3f5cc7382bffcd9">reportMultiQubitParams</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr class="memdesc:aa5e77e0e64f3a4a3d3f5cc7382bffcd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Report metainformation about a set of qubits: number of qubits, number of probability amplitudes.  <a href="#aa5e77e0e64f3a4a3d3f5cc7382bffcd9">More...</a><br /></td></tr>
<tr class="separator:aa5e77e0e64f3a4a3d3f5cc7382bffcd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb5b2eff794339090004d29f02a70d9a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#acb5b2eff794339090004d29f02a70d9a">initStateZero</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit)</td></tr>
<tr class="memdesc:acb5b2eff794339090004d29f02a70d9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the state vector of probability amplitudes for a set of qubits to the zero state: |000...00&gt;  <a href="#acb5b2eff794339090004d29f02a70d9a">More...</a><br /></td></tr>
<tr class="separator:acb5b2eff794339090004d29f02a70d9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43bcb279fc9717fbd06a19cdef48b9d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a43bcb279fc9717fbd06a19cdef48b9d8">initStatePlus</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit)</td></tr>
<tr class="memdesc:a43bcb279fc9717fbd06a19cdef48b9d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the state vector of probability amplitudes for a set of qubits to an equal real superposition of all amplitudes: |+++...++&gt;  <a href="#a43bcb279fc9717fbd06a19cdef48b9d8">More...</a><br /></td></tr>
<tr class="separator:a43bcb279fc9717fbd06a19cdef48b9d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03b3577a891731d505bc4b879fcca9d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a03b3577a891731d505bc4b879fcca9d3">initStateDebug</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> *multiQubit)</td></tr>
<tr class="memdesc:a03b3577a891731d505bc4b879fcca9d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value.  <a href="#a03b3577a891731d505bc4b879fcca9d3">More...</a><br /></td></tr>
<tr class="separator:a03b3577a891731d505bc4b879fcca9d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb059cbcb8c7910a5fc43d21da4f5dea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#acb059cbcb8c7910a5fc43d21da4f5dea">rotateQubitLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="memdesc:acb059cbcb8c7910a5fc43d21da4f5dea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments.  <a href="#acb059cbcb8c7910a5fc43d21da4f5dea">More...</a><br /></td></tr>
<tr class="separator:acb059cbcb8c7910a5fc43d21da4f5dea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ff67d25363f39fd57a4e76621a4bfd5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a6ff67d25363f39fd57a4e76621a4bfd5">rotateQubitDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr class="memdesc:a6ff67d25363f39fd57a4e76621a4bfd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments, and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a6ff67d25363f39fd57a4e76621a4bfd5">More...</a><br /></td></tr>
<tr class="separator:a6ff67d25363f39fd57a4e76621a4bfd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a824d71bae93236d8a3cd43589044eaee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a824d71bae93236d8a3cd43589044eaee">controlRotateQubitLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, const int controlQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="memdesc:a824d71bae93236d8a3cd43589044eaee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments and a control qubit.  <a href="#a824d71bae93236d8a3cd43589044eaee">More...</a><br /></td></tr>
<tr class="separator:a824d71bae93236d8a3cd43589044eaee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab22d031e2507f1d859292103a99e2378"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ab22d031e2507f1d859292103a99e2378">controlRotateQubitDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, const int controlQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr class="memdesc:ab22d031e2507f1d859292103a99e2378"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments, and a subset of the state vector with upper and lower block values stored seperately.  <a href="#ab22d031e2507f1d859292103a99e2378">More...</a><br /></td></tr>
<tr class="separator:ab22d031e2507f1d859292103a99e2378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9e640bb2d0458c937c6a87dfeca0f23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#aa9e640bb2d0458c937c6a87dfeca0f23">sigmaXLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit)</td></tr>
<tr class="memdesc:aa9e640bb2d0458c937c6a87dfeca0f23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#aa9e640bb2d0458c937c6a87dfeca0f23">More...</a><br /></td></tr>
<tr class="separator:aa9e640bb2d0458c937c6a87dfeca0f23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5958808b2f2f05937921ba7dabe5a171"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a5958808b2f2f05937921ba7dabe5a171">sigmaXDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr class="memdesc:a5958808b2f2f05937921ba7dabe5a171"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a5958808b2f2f05937921ba7dabe5a171">More...</a><br /></td></tr>
<tr class="separator:a5958808b2f2f05937921ba7dabe5a171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2901e2e5531cb77f87ea54b3fc28f51a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a2901e2e5531cb77f87ea54b3fc28f51a">controlNotLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, const int controlQubit)</td></tr>
<tr class="memdesc:a2901e2e5531cb77f87ea54b3fc28f51a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0} for elements where controlQubit is one.  <a href="#a2901e2e5531cb77f87ea54b3fc28f51a">More...</a><br /></td></tr>
<tr class="separator:a2901e2e5531cb77f87ea54b3fc28f51a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a774dd1217fcc3591a74a74d5667afa29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a774dd1217fcc3591a74a74d5667afa29">controlNotDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, const int controlQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut)</td></tr>
<tr class="memdesc:a774dd1217fcc3591a74a74d5667afa29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#a774dd1217fcc3591a74a74d5667afa29">More...</a><br /></td></tr>
<tr class="separator:a774dd1217fcc3591a74a74d5667afa29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcbb1dcbe070ad0ed1a72a23251b6a83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#afcbb1dcbe070ad0ed1a72a23251b6a83">sigmaYLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit)</td></tr>
<tr class="memdesc:afcbb1dcbe070ad0ed1a72a23251b6a83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,-i},{i,0}.  <a href="#afcbb1dcbe070ad0ed1a72a23251b6a83">More...</a><br /></td></tr>
<tr class="separator:afcbb1dcbe070ad0ed1a72a23251b6a83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0471f6b547ce8270ef85170b7f4f0214"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a0471f6b547ce8270ef85170b7f4f0214">sigmaYDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecIn, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut, int updateUpper)</td></tr>
<tr class="memdesc:a0471f6b547ce8270ef85170b7f4f0214"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,-i},{i,0}.  <a href="#a0471f6b547ce8270ef85170b7f4f0214">More...</a><br /></td></tr>
<tr class="separator:a0471f6b547ce8270ef85170b7f4f0214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0711416fceaf63c67b496e123e845c69"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a0711416fceaf63c67b496e123e845c69">hadamardLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit)</td></tr>
<tr class="memdesc:a0711416fceaf63c67b496e123e845c69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.  <a href="#a0711416fceaf63c67b496e123e845c69">More...</a><br /></td></tr>
<tr class="separator:a0711416fceaf63c67b496e123e845c69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac835c194bd547240a35f0b028db1d658"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ac835c194bd547240a35f0b028db1d658">hadamardDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecUp, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecLo, <a class="el" href="structComplexArray.html">ComplexArray</a> stateVecOut, int updateUpper)</td></tr>
<tr class="memdesc:ac835c194bd547240a35f0b028db1d658"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.  <a href="#ac835c194bd547240a35f0b028db1d658">More...</a><br /></td></tr>
<tr class="separator:ac835c194bd547240a35f0b028db1d658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a736aeb3532898019fe7c27010edc6a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a6a736aeb3532898019fe7c27010edc6a">phaseGateLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr class="memdesc:a6a736aeb3532898019fe7c27010edc6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the type argument.  <a href="#a6a736aeb3532898019fe7c27010edc6a">More...</a><br /></td></tr>
<tr class="separator:a6a736aeb3532898019fe7c27010edc6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38a05c7e749e806b182ef3b89878bfc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a38a05c7e749e806b182ef3b89878bfc4">phaseGateDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit, enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr class="memdesc:a38a05c7e749e806b182ef3b89878bfc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the type argument.  <a href="#a38a05c7e749e806b182ef3b89878bfc4">More...</a><br /></td></tr>
<tr class="separator:a38a05c7e749e806b182ef3b89878bfc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c90f8302e4f1d8fda23def8753e50fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a9c90f8302e4f1d8fda23def8753e50fe">sigmaZ</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit)</td></tr>
<tr class="memdesc:a9c90f8302e4f1d8fda23def8753e50fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{1,0},{{0,-1}} &ndash; apply a phase of -1 to |1&gt;.  <a href="#a9c90f8302e4f1d8fda23def8753e50fe">More...</a><br /></td></tr>
<tr class="separator:a9c90f8302e4f1d8fda23def8753e50fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1086d84d6a3d5b79137e2f27f18e67e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a1086d84d6a3d5b79137e2f27f18e67e0">sGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit)</td></tr>
<tr class="separator:a1086d84d6a3d5b79137e2f27f18e67e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f33ddd690383fd09cc79bf143e383fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a5f33ddd690383fd09cc79bf143e383fb">tGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int rotQubit)</td></tr>
<tr class="separator:a5f33ddd690383fd09cc79bf143e383fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c02cd0e1b4eac19771a0525f023249e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a7c02cd0e1b4eac19771a0525f023249e">findProbabilityOfZeroLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr class="memdesc:a7c02cd0e1b4eac19771a0525f023249e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk.  <a href="#a7c02cd0e1b4eac19771a0525f023249e">More...</a><br /></td></tr>
<tr class="separator:a7c02cd0e1b4eac19771a0525f023249e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ac9bb717a889f09d307eda9f0b65957"><td class="memItemLeft" align="right" valign="top"><a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a9ac9bb717a889f09d307eda9f0b65957">findProbabilityOfZeroDistributed</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr class="memdesc:a9ac9bb717a889f09d307eda9f0b65957"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk.  <a href="#a9ac9bb717a889f09d307eda9f0b65957">More...</a><br /></td></tr>
<tr class="separator:a9ac9bb717a889f09d307eda9f0b65957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ad4584e44f567c140b653ed36d26ccf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a0ad4584e44f567c140b653ed36d26ccf">controlPhaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int idQubit1, const int idQubit2)</td></tr>
<tr class="memdesc:a0ad4584e44f567c140b653ed36d26ccf"><td class="mdescLeft">&#160;</td><td class="mdescRight">The control phase (the two qubit phase gate).  <a href="#a0ad4584e44f567c140b653ed36d26ccf">More...</a><br /></td></tr>
<tr class="separator:a0ad4584e44f567c140b653ed36d26ccf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca7765bd500718f98700a172351748cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#aca7765bd500718f98700a172351748cc">quadCPhaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int idQubit1, const int idQubit2, const int idQubit3, const int idQubit4)</td></tr>
<tr class="memdesc:aca7765bd500718f98700a172351748cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">The control not gate.  <a href="#aca7765bd500718f98700a172351748cc">More...</a><br /></td></tr>
<tr class="separator:aca7765bd500718f98700a172351748cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53614ce19e0a4f2c41b400cf05dc5bd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a53614ce19e0a4f2c41b400cf05dc5bd1">measureInStateLocal</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int measureQubit, <a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> totalProbability, int outcome)</td></tr>
<tr class="memdesc:a53614ce19e0a4f2c41b400cf05dc5bd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1.  <a href="#a53614ce19e0a4f2c41b400cf05dc5bd1">More...</a><br /></td></tr>
<tr class="separator:a53614ce19e0a4f2c41b400cf05dc5bd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35e5ac30c8427c482a97b33a4e295535"><td class="memItemLeft" align="right" valign="top"><a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a35e5ac30c8427c482a97b33a4e295535">measureInStateDistributedRenorm</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, const <a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> totalProbability)</td></tr>
<tr class="memdesc:a35e5ac30c8427c482a97b33a4e295535"><td class="mdescLeft">&#160;</td><td class="mdescRight">Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1.  <a href="#a35e5ac30c8427c482a97b33a4e295535">More...</a><br /></td></tr>
<tr class="separator:a35e5ac30c8427c482a97b33a4e295535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac39efc9ed939382276ebd0c15dd6a0fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#ac39efc9ed939382276ebd0c15dd6a0fa">measureInStateDistributedSetZero</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit)</td></tr>
<tr class="memdesc:ac39efc9ed939382276ebd0c15dd6a0fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set all amplitudes in one chunk to 0.  <a href="#ac39efc9ed939382276ebd0c15dd6a0fa">More...</a><br /></td></tr>
<tr class="separator:ac39efc9ed939382276ebd0c15dd6a0fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d73fd11c1d154640dbf114da8f34c64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a2d73fd11c1d154640dbf114da8f34c64">filterOut111Local</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int idQubit1, const int idQubit2, const int idQubit3, const <a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> probOfFilter)</td></tr>
<tr class="memdesc:a2d73fd11c1d154640dbf114da8f34c64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the state according to this scenario: we ask "are these 3 qubits in 111" and the answer is "no".  <a href="#a2d73fd11c1d154640dbf114da8f34c64">More...</a><br /></td></tr>
<tr class="separator:a2d73fd11c1d154640dbf114da8f34c64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a096cddbac961f0651a084d2ceb905d1b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a096cddbac961f0651a084d2ceb905d1b">probOfFilterOut111Local</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int idQubit1, const int idQubit2, const int idQubit3)</td></tr>
<tr class="memdesc:a096cddbac961f0651a084d2ceb905d1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the state according to this scenario: we ask "are these 3 qubits in 111" and the answer is "no".  <a href="#a096cddbac961f0651a084d2ceb905d1b">More...</a><br /></td></tr>
<tr class="separator:a096cddbac961f0651a084d2ceb905d1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a799b10447d6dbdaf960a4d3eedd22014"><td class="memItemLeft" align="right" valign="top"><a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qubits_8c.html#a799b10447d6dbdaf960a4d3eedd22014">getProbEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr class="memdesc:a799b10447d6dbdaf960a4d3eedd22014"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get probability of the state at an index in the state vector.  <a href="#a799b10447d6dbdaf960a4d3eedd22014">More...</a><br /></td></tr>
<tr class="separator:a799b10447d6dbdaf960a4d3eedd22014"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The core of the QUEST Library. </p>

<p class="definition">Definition in file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad72dbcf6d0153db1b8d8a58001feed83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad72dbcf6d0153db1b8d8a58001feed83">&#9670;&nbsp;</a></span>DEBUG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00014">14</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits_8c_source.html#l01183">findProbabilityOfZeroLocal()</a>, <a class="el" href="qubits_8c_source.html#l00227">initStateDebug()</a>, <a class="el" href="qubits_8c_source.html#l00189">initStatePlus()</a>, and <a class="el" href="qubits_8c_source.html#l00147">initStateZero()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a774dd1217fcc3591a74a74d5667afa29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a774dd1217fcc3591a74a74d5667afa29">&#9670;&nbsp;</a></span>controlNotDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlNotDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk. Only perform the rotation for elements where controlQubit is one.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00742">742</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8c_source.html#l01323">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00021">REAL</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00371">controlNot()</a>.</p>
<div class="fragment"><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;{</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        assert (targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="preprocessor">        shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="preprocessor">        private  (thisTask,controlBit)</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        {</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                        controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, thisTask);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                        <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                                stateVecRealOut[thisTask] = stateVecRealIn[thisTask];</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                                stateVecImagOut[thisTask] = stateVecImagIn[thisTask];</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                        }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                }</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        }</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;} </div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="qubits_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8c_source.html#l01323">qubits.c:1323</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2901e2e5531cb77f87ea54b3fc28f51a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2901e2e5531cb77f87ea54b3fc28f51a">&#9670;&nbsp;</a></span>controlNotLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlNotLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0} for elements where controlQubit is one. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit to determine whether or not to perform a rotation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00667">667</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8c_source.html#l01323">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00114">controlNot()</a>.</p>
<div class="fragment"><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;{</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;             indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>&gt;&gt;1;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="comment">// if targetQubit==controlQubit, it is guaranteed that controlQubit==1 when</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="comment">// targetQubit==1. As rotations are symmetric, we can instead apply the rotation</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="comment">// on all amplitudes where targetQubit==0 as we do here.</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordtype">int</span> rotateAll=(targetQubit==controlQubit);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        assert (targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="comment">// set dimensions</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag,rotateAll) \</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,controlBit) </span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                        thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                        indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                        indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                        controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(controlQubit, indexUp);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                        <span class="keywordflow">if</span> (rotateAll || controlBit){</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                                stateVecReal[indexUp] = stateVecReal[indexLo];</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                                stateVecImag[indexUp] = stateVecImag[indexLo];</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                                stateVecReal[indexLo] = stateRealUp;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                                stateVecImag[indexLo] = stateImagUp;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                        }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                } </div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="qubits_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8c_source.html#l01323">qubits.c:1323</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ad4584e44f567c140b653ed36d26ccf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ad4584e44f567c140b653ed36d26ccf">&#9670;&nbsp;</a></span>controlPhaseGate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlPhaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The control phase (the two qubit phase gate). </p>
<p>For each state, if both input qubits are equal to zero, multiply the amplitude of that state by -1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idQubit1,idQubit2</td><td>specified qubits </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01334">1334</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8c_source.html#l01323">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;{</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <span class="keywordtype">int</span> bit1, bit2;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        <span class="comment">//            tests                                                 //</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        assert (idQubit1 &gt;= 0 &amp;&amp; idQubit2 &gt;= 0 &amp;&amp; idQubit1 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a> &amp;&amp; idQubit2 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <span class="comment">//            initialise the state to |0000..0&gt;                     //</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="preprocessor"># pragma omp parallel for \</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="preprocessor">        default  (none)                      \</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="preprocessor">        shared   (stateVecSize, stateVecReal,stateVecImag ) \</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="preprocessor">        private  (index,bit1,bit2)                     \</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="preprocessor">        schedule (static)</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                bit1 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit1, index);</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                bit2 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit2, index);</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                        stateVecReal [index] = - stateVecReal [index];</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                        stateVecImag [index] = - stateVecImag [index];</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                }</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        }</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="qubits_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8c_source.html#l01323">qubits.c:1323</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab22d031e2507f1d859292103a99e2378"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22d031e2507f1d859292103a99e2378">&#9670;&nbsp;</a></span>controlRotateQubitDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlRotateQubitDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments, and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00506">506</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8c_source.html#l01323">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00265">controlRotateQubit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;{</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        assert (rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag) \</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                        controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, thisTask);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                        <span class="keywordflow">if</span> (controlBit){</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                        }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="qubits_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8c_source.html#l01323">qubits.c:1323</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00022">qubits.h:22</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00021">qubits.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a824d71bae93236d8a3cd43589044eaee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a824d71bae93236d8a3cd43589044eaee">&#9670;&nbsp;</a></span>controlRotateQubitLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlRotateQubitLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments and a control qubit. </p>
<p>Only perform the rotation for elements where the control qubit is one. alphaRe = cos(angle1) * cos(angle2) <br />
alphaIm = cos(angle1) * sin(angle2) <br />
 betaRe = sin(angle1) * cos(angle3) <br />
 betaIm = sin(angle1) * sin(angle3) <br />
</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beta</td><td>rotation angle </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00415">415</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8c_source.html#l01323">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00089">controlRotateQubit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;{</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;             indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>&gt;&gt;1;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordtype">int</span> controlBit;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="comment">// if targetQubit==controlQubit, it is guaranteed that controlQubit==1 when</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">// targetQubit==1. As rotations are symmetric, we can instead apply the rotation</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment">// on all amplitudes where targetQubit==0 as we do here.</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordtype">int</span> rotateAll=(rotQubit==controlQubit);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        assert (rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">// set dimensions</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        sizeHalfBlock = 1LL &lt;&lt; rotQubit;  </div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> alphaImag=alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> betaImag=beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag,\</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">                        rotateAll) \</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                        thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                        indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                        indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                        controlBit = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, indexUp);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                        <span class="keywordflow">if</span> (rotateAll || controlBit){</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                                <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp </div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                        - betaReal*stateRealLo - betaImag*stateImagLo;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp </div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                        - betaReal*stateImagLo + betaImag*stateRealLo;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp </div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                        + alphaReal*stateRealLo + alphaImag*stateImagLo;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp </div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                        + alphaReal*stateImagLo - alphaImag*stateRealLo;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                        }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                } </div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        }</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;} </div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="qubits_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8c_source.html#l01323">qubits.c:1323</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00022">qubits.h:22</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00021">qubits.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae729f311efd2a426ce5161df3e017a16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae729f311efd2a426ce5161df3e017a16">&#9670;&nbsp;</a></span>createMultiQubit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void createMultiQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQUESTEnv.html">QUESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits. ">MultiQubit</a> object representing a set of qubits. </p>
<p>Allocate space for state vector of probability amplitudes, including space for temporary values to be copied from one other chunk if running the distributed version. Define properties related to the size of the set of qubits. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numQubits</td><td>number of qubits in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00027">27</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00040">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00051">QUESTEnv::numRanks</a>, <a class="el" href="qubits_8h_source.html#l00033">MultiQubit::pairStateVec</a>, <a class="el" href="qubits_8h_source.html#l00050">QUESTEnv::rank</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; numQubits;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/env.<a class="code" href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">numRanks</a>;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>)));</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>)));</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="keywordflow">if</span> (env.<a class="code" href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">numRanks</a>&gt;1){</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>)));</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a> = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>)));</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordflow">if</span> ( (!(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>) || !(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>))</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                 &amp;&amp; numAmpsPerRank ) {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                exit (EXIT_FAILURE);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        }</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">if</span> ( env.<a class="code" href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">numRanks</a>&gt;1 &amp;&amp; (!(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>) || !(multiQubit-&gt;<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>))</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                 &amp;&amp; numAmpsPerRank ) {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                exit (EXIT_FAILURE);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        }</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a> = numQubits;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a> = numAmpsPerRank;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a> = env.<a class="code" href="structQUESTEnv.html#a1bdb6d425a2ce6a468f93929c0b26d73">rank</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a> = env.<a class="code" href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">numRanks</a>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="structQUESTEnv_html_a1bdb6d425a2ce6a468f93929c0b26d73"><div class="ttname"><a href="structQUESTEnv.html#a1bdb6d425a2ce6a468f93929c0b26d73">QUESTEnv::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00050">qubits.h:50</a></div></div>
<div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into  the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00042">qubits.h:42</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structQUESTEnv_html_ab9d9ce82e2d5f1b39aa9efc3accb3742"><div class="ttname"><a href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">QUESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00051">qubits.h:51</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00033">qubits.h:33</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00040">qubits.h:40</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab796aea79288b974f63474db650be878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab796aea79288b974f63474db650be878">&#9670;&nbsp;</a></span>destroyMultiQubit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyMultiQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQUESTEnv.html">QUESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocate a <a class="el" href="structMultiQubit.html" title="Represents a system of qubits. ">MultiQubit</a> object representing a set of qubits Free memory allocated to state vector of probability amplitudes, including temporary vector for values copied from another chunk if running the distributed version. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object to be deallocated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00063">63</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00051">QUESTEnv::numRanks</a>, <a class="el" href="qubits_8h_source.html#l00033">MultiQubit::pairStateVec</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                                           {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        free(multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        free(multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">if</span> (env.<a class="code" href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">numRanks</a>&gt;1){</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                free(multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                free(multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="structQUESTEnv_html_ab9d9ce82e2d5f1b39aa9efc3accb3742"><div class="ttname"><a href="structQUESTEnv.html#ab9d9ce82e2d5f1b39aa9efc3accb3742">QUESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00051">qubits.h:51</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00033">qubits.h:33</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a100463f6ec212c76a5fad99579000505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a100463f6ec212c76a5fad99579000505">&#9670;&nbsp;</a></span>extractBit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int extractBit </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>locationOfBitFromRight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long long int&#160;</td>
          <td class="paramname"><em>theEncodedNumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the value of the bit at a particular index in a number. </p>
<p>SCB edit: new definition of extractBit is much faster *** </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">locationOfBitFromRight</td><td>location of bit in theEncodedNumber </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">theEncodedNumber</td><td>number to search </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the value of the bit in theEncodedNumber </dd></dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01323">1323</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits_8c_source.html#l00742">controlNotDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00667">controlNotLocal()</a>, <a class="el" href="qubits_8c_source.html#l01334">controlPhaseGate()</a>, <a class="el" href="qubits_8c_source.html#l00506">controlRotateQubitDistributed()</a>, <a class="el" href="qubits_8c_source.html#l00415">controlRotateQubitLocal()</a>, <a class="el" href="qubits_8c_source.html#l01652">filterOut111Local()</a>, <a class="el" href="qubits_8c_source.html#l01702">probOfFilterOut111Local()</a>, and <a class="el" href="qubits_8c_source.html#l01421">quadCPhaseGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;{</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="keywordflow">return</span> (theEncodedNumber &amp; ( 1LL &lt;&lt; locationOfBitFromRight )) &gt;&gt; locationOfBitFromRight;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a2d73fd11c1d154640dbf114da8f34c64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d73fd11c1d154640dbf114da8f34c64">&#9670;&nbsp;</a></span>filterOut111Local()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void filterOut111Local </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>probOfFilter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the state according to this scenario: we ask "are these 3 qubits in 111" and the answer is "no". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idQubit1,idQubit2,idQubit3</td><td>specified qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">probOfFilter</td><td>Total probability that the 3 qubits are not all in the 1 state. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01652">1652</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8c_source.html#l01323">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, <a class="el" href="precision_8h_source.html#l00023">REAL_STRING_FORMAT</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00135">filterOut111()</a>.</p>
<div class="fragment"><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;{</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        <span class="keywordtype">int</span> bit1, bit2, bit3;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        <span class="comment">//            tests                                                 //</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        assert (idQubit1 &gt;= 0 &amp;&amp; idQubit2 &gt;= 0 &amp;&amp; idQubit1 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a> &amp;&amp; idQubit2 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        <span class="keywordflow">if</span> ( probOfFilter&lt;1e-16 ){ printf(<span class="stringliteral">&quot;Extremely small or negative profOfFilter=&quot;</span><a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a><span class="stringliteral">&quot;; aborting! \n&quot;</span>,probOfFilter); exit(1);}</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> myNorm=1/sqrt(probOfFilter);</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="preprocessor">        default  (none)                      \</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="preprocessor">        shared   (stateVecSize, stateVecReal,stateVecImag, myNorm) \</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="preprocessor">        private  (index,bit1,bit2,bit3)                </span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        {</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                        bit1 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit1, index);</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                        bit2 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit2, index);</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                        bit3 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit3, index);</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                        <span class="keywordflow">if</span> ((bit1 &amp;&amp; bit2 &amp;&amp; bit3)) {</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                                stateVecReal[index]=0;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                                stateVecImag [index]=0;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                                stateVecReal[index] *= myNorm;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                                stateVecImag[index] *= myNorm;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                        }</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                }</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        }</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_ad751ac7ddc8ec19f23fb33083c0da8da"><div class="ttname"><a href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a></div><div class="ttdeci">#define REAL_STRING_FORMAT</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00023">precision.h:23</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="qubits_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8c_source.html#l01323">qubits.c:1323</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ac9bb717a889f09d307eda9f0b65957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ac9bb717a889f09d307eda9f0b65957">&#9670;&nbsp;</a></span>findProbabilityOfZeroDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> findProbabilityOfZeroDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk. </p>
<p>Size of regions to skip is a multiple of chunkSize.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01262">1262</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00573">findProbabilityOfOutcome()</a>.</p>
<div class="fragment"><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;{</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <span class="comment">// ----- measured probability</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   totalProbability;                                    <span class="comment">// probability (returned) value</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <span class="comment">// (good for shared memory parallelism)</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="comment">//            tests                                                 //</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        assert (measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="comment">//            find probability                                      //</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="comment">// initialise returned value</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        totalProbability = 0.0;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="preprocessor">        shared    (numTasks,stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="preprocessor">        private   (thisTask) \</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="preprocessor">        reduction ( +:totalProbability )</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        {</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="preprocessor">                # pragma omp for schedule  (static)</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                        <span class="comment">// summation -- simple implementation</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                        totalProbability += stateVecReal[thisTask]*stateVecReal[thisTask]</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                                + stateVecImag[thisTask]*stateVecImag[thisTask];</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                        <span class="comment">/*</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">                        // summation -- kahan correction</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">                        y = stateVecReal[thisTask]*stateVecReal[thisTask]</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">                        + stateVecImag[thisTask]*stateVecImag[thisTask] - c;</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">                        t = totalProbability + y;</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">                        c = (t - totalProbability) - y;</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">                        totalProbability = t;</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="comment">                        */</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                }</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        }</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="keywordflow">return</span> totalProbability;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c02cd0e1b4eac19771a0525f023249e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c02cd0e1b4eac19771a0525f023249e">&#9670;&nbsp;</a></span>findProbabilityOfZeroLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> findProbabilityOfZeroLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk. </p>
<p>Size of regions to skip is less than the size of one chunk.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01183">1183</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8c_source.html#l00014">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00119">findProbabilityOfOutcome()</a>.</p>
<div class="fragment"><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;{</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="comment">// ----- sizes</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                           <span class="comment">// size of blocks</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <span class="comment">// ----- indices</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                           <span class="comment">// current block</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;             index;                                               <span class="comment">// current index for first half block</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="comment">// ----- measured probability</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   totalProbability;                                    <span class="comment">// probability (returned) value</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>&gt;&gt;1;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="comment">//            tests                                                 //</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        assert (measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        <span class="comment">//            dimensions                                            //</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="comment">// and then the number to skip</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        sizeBlock     = 2LL * sizeHalfBlock;                           <span class="comment">// size of blocks (pairs of measure and skip entries)</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <span class="comment">// initialise returned value</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        totalProbability = 0.0;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="comment">// initialise correction for kahan summation</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;sizeHalfBlock=%Ld sizeBlock=%Ld numTasks=%Ld\n&quot;</span>,sizeHalfBlock,sizeBlock,numTasks);</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="preprocessor">        shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="preprocessor">        private   (thisTask,thisBlock,index) \</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="preprocessor">        reduction ( +:totalProbability )</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        {</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="preprocessor">                # pragma omp for schedule  (static)</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                        thisBlock = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                        index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                        <span class="keywordflow">if</span> (index&lt;0){ printf(<span class="stringliteral">&quot;ABORTING as index=%Ld with thisBlock = %Ld  thisTask=%Ld \n&quot;</span>, index,thisBlock,thisTask); exit(1);}</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                        <span class="comment">// summation -- simple implementation</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                        totalProbability += stateVecReal[index]*stateVecReal[index]</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                                + stateVecImag[index]*stateVecImag[index];</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                        <span class="comment">/*</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">                        // summation -- kahan correction</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment">                        y = stateVecReal[index]*stateVecReal[index]</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">                        + stateVecImag[index]*stateVecImag[index] - c;</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">                        t = totalProbability + y;</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">                        c = (t - totalProbability) - y;</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">                        totalProbability = t;</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">                        */</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                }</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        }</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="keywordflow">return</span> totalProbability;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="qubits_8c_html_ad72dbcf6d0153db1b8d8a58001feed83"><div class="ttname"><a href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></div><div class="ttdeci">#define DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8c_source.html#l00014">qubits.c:14</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a799b10447d6dbdaf960a4d3eedd22014"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a799b10447d6dbdaf960a4d3eedd22014">&#9670;&nbsp;</a></span>getProbEl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> getProbEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get probability of the state at an index in the state vector. </p>
<p>Get the probability of the state at an index in the state vector.</p>
<p>For debugging purposes. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">multiQubit</td><td>object representing a set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>real component * real component + imag component * imag component </dd></dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01748">1748</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits__env__local_8c_source.html#l00079">getImagAmpEl()</a>, <a class="el" href="qubits__env__local_8c_source.html#l00075">getRealAmpEl()</a>, and <a class="el" href="precision_8h_source.html#l00021">REAL</a>.</p>
<div class="fragment"><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                                                          {</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> real;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> imag;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        real = <a class="code" href="qubits_8h.html#a317b786f577fa6bc136ea7f0ee7330a7">getRealAmpEl</a>(multiQubit, index);</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        imag = <a class="code" href="qubits_8h.html#a3615f76fd5f57008d9b74bbd10533dd0">getImagAmpEl</a>(multiQubit, index);</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        <span class="keywordflow">return</span> real*real + imag*imag;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;}</div><div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="qubits_8h_html_a3615f76fd5f57008d9b74bbd10533dd0"><div class="ttname"><a href="qubits_8h.html#a3615f76fd5f57008d9b74bbd10533dd0">getImagAmpEl</a></div><div class="ttdeci">REAL getImagAmpEl(MultiQubit multiQubit, long long int index)</div><div class="ttdoc">Get the imaginary component of the probability amplitude at an index in the state vector...</div><div class="ttdef"><b>Definition:</b> <a href="qubits__env__local_8c_source.html#l00079">qubits_env_local.c:79</a></div></div>
<div class="ttc" id="qubits_8h_html_a317b786f577fa6bc136ea7f0ee7330a7"><div class="ttname"><a href="qubits_8h.html#a317b786f577fa6bc136ea7f0ee7330a7">getRealAmpEl</a></div><div class="ttdeci">REAL getRealAmpEl(MultiQubit multiQubit, long long int index)</div><div class="ttdoc">Get the real component of the probability amplitude at an index in the state vector. </div><div class="ttdef"><b>Definition:</b> <a href="qubits__env__local_8c_source.html#l00075">qubits_env_local.c:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac835c194bd547240a35f0b028db1d658"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac835c194bd547240a35f0b028db1d658">&#9670;&nbsp;</a></span>hadamardDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamardDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>updateUpper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">updateUpper</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00961">961</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00021">REAL</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00496">hadamard()</a>.</p>
<div class="fragment"><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;{</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        assert (rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keywordtype">int</span> sign;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">if</span> (updateUpper) sign=1;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordflow">else</span> sign=-1;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="preprocessor">                        recRoot2, sign) \</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        {</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                        <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                        stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                        stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                        stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                        stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                        stateVecRealOut[thisTask] = recRoot2*(stateRealUp + sign*stateRealLo);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                        stateVecImagOut[thisTask] = recRoot2*(stateImagUp + sign*stateImagLo);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                }</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        }</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0711416fceaf63c67b496e123e845c69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0711416fceaf63c67b496e123e845c69">&#9670;&nbsp;</a></span>hadamardLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamardLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00893">893</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00109">hadamard()</a>.</p>
<div class="fragment"><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;{</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;             indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>&gt;&gt;1;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        assert (rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="comment">// set dimensions</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        sizeHalfBlock = 1LL &lt;&lt; rotQubit;  </div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, recRoot2) \</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                        thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                        indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                        indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                        stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                        stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                        stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                        stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                        stateVecReal[indexUp] = recRoot2*(stateRealUp + stateRealLo);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                        stateVecImag[indexUp] = recRoot2*(stateImagUp + stateImagLo);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                        stateVecReal[indexLo] = recRoot2*(stateRealUp - stateRealLo);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                        stateVecImag[indexLo] = recRoot2*(stateImagUp - stateImagLo);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                } </div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        }</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a03b3577a891731d505bc4b879fcca9d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03b3577a891731d505bc4b879fcca9d3">&#9670;&nbsp;</a></span>initStateDebug()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateDebug </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value. </p>
<p>For debugging processes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00227">227</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00040">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l00014">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        stateVecSize = chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="comment">// Can&#39;t use multiQubit-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> chunkOffset = (2.0*chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>)/10.0;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">        shared   (chunkSize, stateVecReal, stateVecImag, chunkOffset) \</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor">        private  (index) </span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                        stateVecReal[index] = chunkOffset + (index*2.0)/10.0;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                        stateVecImag[index] = chunkOffset + (index*2.0+1.0)/10.0;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;COMPLETED INIT\n&quot;</span>);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into  the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00042">qubits.h:42</a></div></div>
<div class="ttc" id="qubits_8c_html_ad72dbcf6d0153db1b8d8a58001feed83"><div class="ttname"><a href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></div><div class="ttdeci">#define DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8c_source.html#l00014">qubits.c:14</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00040">qubits.h:40</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a43bcb279fc9717fbd06a19cdef48b9d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43bcb279fc9717fbd06a19cdef48b9d8">&#9670;&nbsp;</a></span>initStatePlus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStatePlus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the state vector of probability amplitudes for a set of qubits to an equal real superposition of all amplitudes: |+++...++&gt; </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00189">189</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8c_source.html#l00014">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;{</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        chunkSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        stateVecSize = chunkSize*multiQubit-&gt;<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> normFactor = 1.0/sqrt(stateVecSize);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">// Can&#39;t use multiQubit-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">        shared   (chunkSize, stateVecReal, stateVecImag, normFactor) \</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">        private  (index) </span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                        stateVecReal[index] = normFactor;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                        stateVecImag[index] = 0.0;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;COMPLETED INIT\n&quot;</span>);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into  the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00042">qubits.h:42</a></div></div>
<div class="ttc" id="qubits_8c_html_ad72dbcf6d0153db1b8d8a58001feed83"><div class="ttname"><a href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></div><div class="ttdeci">#define DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8c_source.html#l00014">qubits.c:14</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acb5b2eff794339090004d29f02a70d9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb5b2eff794339090004d29f02a70d9a">&#9670;&nbsp;</a></span>initStateZero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initStateZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a> *&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the state vector of probability amplitudes for a set of qubits to the zero state: |000...00&gt; </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00147">147</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00040">MultiQubit::chunkId</a>, <a class="el" href="qubits_8c_source.html#l00014">DEBUG</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;{</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">// dimension of the state vector</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        stateVecSize = multiQubit-&gt;<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">// Can&#39;t use multiQubit-&gt;stateVec as a private OMP var</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit-&gt;<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">// initialise the state to |0000..0000&gt;</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">        shared   (stateVecSize, stateVecReal, stateVecImag) \</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">        private  (index) </span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                        stateVecReal[index] = 0.0;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                        stateVecImag[index] = 0.0;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span> (multiQubit-&gt;<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>==0){</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="comment">// zero state |0000..0000&gt; has probability 1</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                stateVecReal[0] = 1.0;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                stateVecImag[0] = 0.0;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>) printf(<span class="stringliteral">&quot;COMPLETED INIT\n&quot;</span>);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="qubits_8c_html_ad72dbcf6d0153db1b8d8a58001feed83"><div class="ttname"><a href="qubits_8c.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></div><div class="ttdeci">#define DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8c_source.html#l00014">qubits.c:14</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00040">qubits.h:40</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a35e5ac30c8427c482a97b33a4e295535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35e5ac30c8427c482a97b33a4e295535">&#9670;&nbsp;</a></span>measureInStateDistributedRenorm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> measureInStateDistributedRenorm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>totalProbability</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that the value 'outcome' has been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles the renormalisation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">totalProbability</td><td>probability of qubit measureQubit being zero </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01563">1563</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00590">measureInState()</a>.</p>
<div class="fragment"><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;{</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="comment">// (good for shared memory parallelism)</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        <span class="comment">//            tests                                                 //</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        assert (measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> renorm=1/sqrt(totalProbability);</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        </div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="preprocessor">        shared    (numTasks,stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="preprocessor">        private   (thisTask)</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        {</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="preprocessor">                # pragma omp for schedule  (static)</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                        <span class="comment">// summation -- simple implementation</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                        stateVecReal[thisTask] = stateVecReal[thisTask]*renorm;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                        stateVecImag[thisTask] = stateVecImag[thisTask]*renorm;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                }</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        }</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        <span class="keywordflow">return</span> totalProbability;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac39efc9ed939382276ebd0c15dd6a0fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac39efc9ed939382276ebd0c15dd6a0fa">&#9670;&nbsp;</a></span>measureInStateDistributedSetZero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void measureInStateDistributedSetZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set all amplitudes in one chunk to 0. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that a zero have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles setting amplitudes to 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01611">1611</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00590">measureInState()</a>.</p>
<div class="fragment"><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;{</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        <span class="comment">// (good for shared memory parallelism)</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        <span class="comment">//            tests                                                 //</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        assert (measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        <span class="comment">//            find probability                                      //</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="preprocessor">        shared    (numTasks,stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="preprocessor">        private   (thisTask)</span></div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        {</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="preprocessor">                # pragma omp for schedule  (static)</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                        <span class="comment">// summation -- simple implementation</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                        stateVecReal[thisTask] = 0;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                        stateVecImag[thisTask] = 0;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                }</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        }</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a53614ce19e0a4f2c41b400cf05dc5bd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53614ce19e0a4f2c41b400cf05dc5bd1">&#9670;&nbsp;</a></span>measureInStateLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void measureInStateLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td>
          <td class="paramname"><em>totalProbability</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. </p>
<p>Performs an irreversible change to the state vector: it updates the vector according to the event that an outcome have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1 according to the value of outcome. In the local version, one or more blocks (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) fit entirely into one chunk.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">totalProbability</td><td>probability of qubit measureQubit being either zero or one </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">outcome</td><td>to measure the probability of and set the state to &ndash; either zero or one </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01475">1475</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00127">measureInState()</a>.</p>
<div class="fragment"><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;{</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="comment">// ----- sizes</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                           <span class="comment">// size of blocks</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        <span class="comment">// ----- indices</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                           <span class="comment">// current block</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;             index;                                               <span class="comment">// current index for first half block</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        <span class="comment">// ----- measured probability</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   renorm;                                    <span class="comment">// probability (returned) value</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <span class="comment">// ----- temp variables</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        <span class="comment">// (good for shared memory parallelism)</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>&gt;&gt;1;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        <span class="comment">//            tests                                                 //</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        assert (measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <span class="comment">//            dimensions                                            //</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        <span class="comment">// and then the number to skip</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        sizeBlock     = 2LL * sizeHalfBlock;                           <span class="comment">// size of blocks (pairs of measure and skip entries)</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        </div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        renorm=1/sqrt(totalProbability);</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="preprocessor">        default (none) \</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="preprocessor">        shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag,renorm,outcome) \</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="preprocessor">        private   (thisTask,thisBlock,index)</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        {</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                <span class="keywordflow">if</span> (outcome==0){</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                        <span class="comment">// measure qubit is 0</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="preprocessor">                        # pragma omp for schedule  (static)</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                                thisBlock = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                                index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                                stateVecReal[index]=stateVecReal[index]*renorm;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                                stateVecImag[index]=stateVecImag[index]*renorm;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                                stateVecReal[index+sizeHalfBlock]=0;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                                stateVecImag[index+sizeHalfBlock]=0;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                        }</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                        <span class="comment">// measure qubit is 1</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="preprocessor">                        # pragma omp for schedule  (static)</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                                thisBlock = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                                index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                                stateVecReal[index]=0;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                                stateVecImag[index]=0;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                                stateVecReal[index+sizeHalfBlock]=stateVecReal[index+sizeHalfBlock]*renorm;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                                stateVecImag[index+sizeHalfBlock]=stateVecImag[index+sizeHalfBlock]*renorm;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                        }</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                }</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        }</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a38a05c7e749e806b182ef3b89878bfc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38a05c7e749e806b182ef3b89878bfc4">&#9670;&nbsp;</a></span>phaseGateDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGateDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the type argument. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>the type of phase gate to apply &ndash; one of {SIGMA_Z, S_GATE, T_GATE} </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01103">1103</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, <a class="el" href="qubits_8h_source.html#l00055">S_GATE</a>, <a class="el" href="qubits_8h_source.html#l00055">SIGMA_Z</a>, <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8h_source.html#l00055">T_GATE</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00475">phaseGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;{</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealLo,stateImagLo;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        assert (rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="preprocessor">        shared   (stateVecReal,stateVecImag, recRoot2, type) \</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="preprocessor">        private  (thisTask,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        {</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>){</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="preprocessor"># ifdef _openmp</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="preprocessor">                        # pragma omp for schedule (static)</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                                stateVecReal[thisTask] = -stateVecReal[thisTask];</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                                stateVecImag[thisTask] = -stateVecImag[thisTask];</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                        } </div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>){</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="preprocessor"># ifdef _openmp</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="preprocessor">                        # pragma omp for schedule (static)</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                                stateRealLo = stateVecReal[thisTask];</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                                stateImagLo = stateVecImag[thisTask];</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                                stateVecReal[thisTask] = -stateImagLo;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                                stateVecImag[thisTask] = stateRealLo;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                        } </div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>){</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="preprocessor">                        # pragma omp for schedule (static)</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                stateRealLo = stateVecReal[thisTask];</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                stateImagLo = stateVecImag[thisTask];</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                                stateVecReal[thisTask] = recRoot2 * (stateRealLo - stateImagLo);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                                stateVecImag[thisTask] = recRoot2 * (stateRealLo + stateImagLo);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                        } </div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Type %d is an invalid phase gate\n&quot;</span>, type);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        }</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="qubits_8h_html_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac"><div class="ttname"><a href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a></div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00055">qubits.h:55</a></div></div>
<div class="ttc" id="qubits_8h_html_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f"><div class="ttname"><a href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a></div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00055">qubits.h:55</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="qubits_8h_html_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab"><div class="ttname"><a href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a></div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00055">qubits.h:55</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a736aeb3532898019fe7c27010edc6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a736aeb3532898019fe7c27010edc6a">&#9670;&nbsp;</a></span>phaseGateLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGateLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="qubits_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the type argument. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>the type of phase gate to apply &ndash; one of {SIGMA_Z, S_GATE, T_GATE} </td></tr>
  </table>
  </dd>
</dl>
<p>fix &ndash; can i rewrite this to not use mod?</p>
<p>fix &ndash; can i rewrite this to not use mod?</p>
<p>fix &ndash; can i rewrite this to not use mod? </p>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01017">1017</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, <a class="el" href="qubits_8h_source.html#l00055">S_GATE</a>, <a class="el" href="qubits_8h_source.html#l00055">SIGMA_Z</a>, <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>, and <a class="el" href="qubits_8h_source.html#l00055">T_GATE</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00104">phaseGate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;{</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;             indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealLo,stateImagLo;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>&gt;&gt;1;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        assert (rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="comment">// set dimensions</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        sizeHalfBlock = 1LL &lt;&lt; rotQubit;  </div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> recRoot2 = 1.0/sqrt(2);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock,stateVecReal,stateVecImag,recRoot2,type) \</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="preprocessor">        private  (thisTask,thisBlock,indexUp,indexLo,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        {</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>){</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="preprocessor">                        # pragma omp for schedule (static)</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                                thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                                indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                                indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                                stateVecReal[indexLo] = -stateVecReal[indexLo];</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                                stateVecImag[indexLo] = -stateVecImag[indexLo];</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                        } </div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                } </div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                </div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>){</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="preprocessor">                        # pragma omp for schedule (static)</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                                thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                                indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                                stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                                stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                                stateVecReal[indexLo] = -stateImagLo;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                                stateVecImag[indexLo] = stateRealLo;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                        } </div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>){</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="preprocessor">                        # pragma omp for schedule (static)</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                                thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                                indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                                indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                                stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                                stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                                stateVecReal[indexLo] = recRoot2 * (stateRealLo - stateImagLo);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                stateVecImag[indexLo] = recRoot2 * (stateRealLo + stateImagLo);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                        } </div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Type %d is an invalid phase gate\n&quot;</span>, type);</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        }</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="qubits_8h_html_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac"><div class="ttname"><a href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a></div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00055">qubits.h:55</a></div></div>
<div class="ttc" id="qubits_8h_html_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f"><div class="ttname"><a href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a></div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00055">qubits.h:55</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="qubits_8h_html_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab"><div class="ttname"><a href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a></div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00055">qubits.h:55</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a096cddbac961f0651a084d2ceb905d1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a096cddbac961f0651a084d2ceb905d1b">&#9670;&nbsp;</a></span>probOfFilterOut111Local()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> probOfFilterOut111Local </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates the state according to this scenario: we ask "are these 3 qubits in 111" and the answer is "no". </p>
<p>The function returns the probability of this outcome across all amplitudes in this chunk (if zero, it will exit with error) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idQubit1,idQubit2,idQubit3</td><td>specified qubits </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Total probability that the 3 qubits are not all in the 1 state. </dd></dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01702">1702</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8c_source.html#l01323">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00143">probOfFilterOut111()</a>.</p>
<div class="fragment"><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;{</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="keywordtype">int</span> bit1, bit2, bit3;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        <span class="comment">//            tests                                                 //</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        assert (idQubit1 &gt;= 0 &amp;&amp; idQubit2 &gt;= 0 &amp;&amp; idQubit1 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a> &amp;&amp; idQubit2 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> probOfFilter=0;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        </div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="preprocessor">        default  (none)                      \</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="preprocessor">        shared   (stateVecSize, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="preprocessor">        private  (index,bit1,bit2,bit3)                \</span></div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="preprocessor">        reduction ( +:probOfFilter )</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        {</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                        bit1 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit1, index);</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                        bit2 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit2, index);</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                        bit3 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit3, index);</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                        <span class="keywordflow">if</span> (!(bit1 &amp;&amp; bit2 &amp;&amp; bit3)) {</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                                probOfFilter+= stateVecReal[index]*stateVecReal[index] + stateVecImag[index]* stateVecImag [index];</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                        }</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                }</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        }</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <span class="keywordflow">return</span> probOfFilter;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="qubits_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8c_source.html#l01323">qubits.c:1323</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aca7765bd500718f98700a172351748cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca7765bd500718f98700a172351748cc">&#9670;&nbsp;</a></span>quadCPhaseGate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void quadCPhaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>idQubit4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The control not gate. </p>
<p>The control phase (the four qubit phase gate). For each state, if all four input qubits are equal to zero, multiply the amplitude of that state by -1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idQubit1,idQubit2,idQubit3,idQubit4</td><td>specified qubits </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01421">1421</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8c_source.html#l01323">extractBit()</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;{</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <span class="keywordtype">int</span> bit1, bit2, bit3, bit4;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <span class="comment">//            tests                                                 //</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        <span class="comment">// ---------------------------------------------------------------- //</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        assert (idQubit1 &gt;= 0 &amp;&amp; idQubit2 &gt;= 0 &amp;&amp; idQubit1 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a> &amp;&amp; idQubit2 &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        stateVecSize = multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="preprocessor">        default  (none)                      \</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="preprocessor">        shared   (stateVecSize, stateVecReal,stateVecImag ) \</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="preprocessor">        private  (index,bit1,bit2,bit3,bit4)</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        {</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                        bit1 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit1, index);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                        bit2 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit2, index);</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                        bit3 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit3, index);</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                        bit4 = <a class="code" href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit4, index);</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                        <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2 &amp;&amp; bit3 &amp;&amp; bit4) {</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                                stateVecReal [index] = - stateVecReal [index];</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                                stateVecImag [index] = - stateVecImag [index];</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                        }</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                }</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        }</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="qubits_8c_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="qubits_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdoc">Get the value of the bit at a particular index in a number. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8c_source.html#l01323">qubits.c:1323</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5e77e0e64f3a4a3d3f5cc7382bffcd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5e77e0e64f3a4a3d3f5cc7382bffcd9">&#9670;&nbsp;</a></span>reportMultiQubitParams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportMultiQubitParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Report metainformation about a set of qubits: number of qubits, number of probability amplitudes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment (local, multinode etc) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00132">132</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00040">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::numChunks</a>, and <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>.</p>
<div class="fragment"><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                                  {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>==0){</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                printf(<span class="stringliteral">&quot;QUBITS:\n&quot;</span>);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                printf(<span class="stringliteral">&quot;Number of qubits is %d.\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                printf(<span class="stringliteral">&quot;Number of amps is %lld.\n&quot;</span>, numAmps);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                printf(<span class="stringliteral">&quot;Number of amps per rank is %lld.\n&quot;</span>, numAmpsPerRank);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div><div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into  the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00042">qubits.h:42</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00040">qubits.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a96f4de9ce7fefc7680a44d601fc3d894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96f4de9ce7fefc7680a44d601fc3d894">&#9670;&nbsp;</a></span>reportState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to file. </p>
<p>File format: </p><pre class="fragment">real, imag
realComponent1, imagComponent1
realComponent2, imagComponent2
...
realComponentN, imagComponentN
</pre><p>File naming convention:</p>
<p>For each node that the program runs on, a file 'state_rank_[node_rank].csv' is generated. If there is more than one node, ranks after the first do not include the header </p><pre class="fragment">real, imag
</pre><p> so that files are easier to combine. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00092">92</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00040">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL_STRING_FORMAT</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                       {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        FILE *state;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordtype">char</span> filename[100];</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        sprintf(filename, <span class="stringliteral">&quot;state_rank_%d.csv&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        state = fopen(filename, <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>==0) fprintf(state, <span class="stringliteral">&quot;real, imag\n&quot;</span>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">for</span>(index=0; index&lt;multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>; index++){</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                fprintf(state, <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;,&quot;</span> <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index], multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        fclose(state);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_ad751ac7ddc8ec19f23fb33083c0da8da"><div class="ttname"><a href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a></div><div class="ttdeci">#define REAL_STRING_FORMAT</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00023">precision.h:23</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00040">qubits.h:40</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe2c2118c4311ed5d641d3fd83186be8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe2c2118c4311ed5d641d3fd83186be8">&#9670;&nbsp;</a></span>reportStateToScreen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportStateToScreen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQUESTEnv.html">QUESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to standard out. </p>
<p>For debugging purposes. Each rank should print output serially. Only print output for systems &lt;= 5 qubits </p>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00109">109</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00040">MultiQubit::chunkId</a>, <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00042">MultiQubit::numChunks</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00023">REAL_STRING_FORMAT</a>, <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>, and <a class="el" href="qubits__env__local_8c_source.html#l00018">syncQUESTEnv()</a>.</p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                                             {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordtype">int</span> rank;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>&lt;=5){</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <span class="keywordflow">for</span> (rank=0; rank&lt;multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>; rank++){</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                        <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>==rank){</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                printf(<span class="stringliteral">&quot;Reporting state from rank %d [\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                printf(<span class="stringliteral">&quot;\trank, index, real, imag\n&quot;</span>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                <span class="keywordflow">for</span>(index=0; index&lt;multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>; index++){</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                        printf(<span class="stringliteral">&quot;\t%d, %lld, &quot;</span> <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;, &quot;</span> <a class="code" href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a> <span class="stringliteral">&quot;\n&quot;</span>, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, index+rank*multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>, multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index], multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                printf(<span class="stringliteral">&quot;]\n&quot;</span>);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                        }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                        <a class="code" href="qubits_8h.html#a83dffc500bf5b4e41dd63ba1ea9422ae">syncQUESTEnv</a>(env);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_ad751ac7ddc8ec19f23fb33083c0da8da"><div class="ttname"><a href="precision_8h.html#ad751ac7ddc8ec19f23fb33083c0da8da">REAL_STRING_FORMAT</a></div><div class="ttdeci">#define REAL_STRING_FORMAT</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00023">precision.h:23</a></div></div>
<div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into  the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00042">qubits.h:42</a></div></div>
<div class="ttc" id="qubits_8h_html_a83dffc500bf5b4e41dd63ba1ea9422ae"><div class="ttname"><a href="qubits_8h.html#a83dffc500bf5b4e41dd63ba1ea9422ae">syncQUESTEnv</a></div><div class="ttdeci">void syncQUESTEnv(QUESTEnv env)</div><div class="ttdoc">Guarantees that all code up to the given point has been executed on all nodes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits__env__local_8c_source.html#l00018">qubits_env_local.c:18</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00040">qubits.h:40</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ff67d25363f39fd57a4e76621a4bfd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ff67d25363f39fd57a4e76621a4bfd5">&#9670;&nbsp;</a></span>rotateQubitDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateQubitDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments, and a subset of the state vector with upper and lower block values stored seperately. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00354">354</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00207">rotateQubit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;{</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        assert (rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot1Real=rot1.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> rot2Real=rot2.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealUp=stateVecUp.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagUp=stateVecUp.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealLo=stateVecLo.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagLo=stateVecLo.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">        shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">                        rot1Real,rot1Imag, rot2Real,rot2Imag) \</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="preprocessor">        private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                        <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                        stateRealUp = stateVecRealUp[thisTask];</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                        stateImagUp = stateVecImagUp[thisTask];</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                        stateRealLo = stateVecRealLo[thisTask];</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                        stateImagLo = stateVecImagLo[thisTask];</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00022">qubits.h:22</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00021">qubits.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acb059cbcb8c7910a5fc43d21da4f5dea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb059cbcb8c7910a5fc43d21da4f5dea">&#9670;&nbsp;</a></span>rotateQubitLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rotateQubitLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given the angle rotation arguments. </p>
<p>alphaRe = cos(angle1) * cos(angle2) <br />
alphaIm = cos(angle1) * sin(angle2) <br />
 betaRe = sin(angle1) * cos(angle3) <br />
 betaIm = sin(angle1) * sin(angle3) <br />
</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beta</td><td>rotation angle </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00275">275</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00022">Complex::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="qubits_8h_source.html#l00021">Complex::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00083">rotateQubit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;{</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;             indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>&gt;&gt;1;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        assert (rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="comment">// set dimensions</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        sizeHalfBlock = 1LL &lt;&lt; rotQubit;  </div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> alphaImag=alpha.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> betaImag=beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                        thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                        <span class="comment">// store current state vector values in temp variables</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                        stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                        stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                        stateRealLo = stateVecReal[indexLo];</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                        stateImagLo = stateVecImag[indexLo];</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                        <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                        stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp </div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                - betaReal*stateRealLo - betaImag*stateImagLo;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                        stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp </div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                - betaReal*stateImagLo + betaImag*stateRealLo;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                        stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp </div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                + alphaReal*stateRealLo + alphaImag*stateImagLo;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                        stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp </div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                + alphaReal*stateImagLo - alphaImag*stateRealLo;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                } </div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;} </div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00022">qubits.h:22</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00021">qubits.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1086d84d6a3d5b79137e2f27f18e67e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1086d84d6a3d5b79137e2f27f18e67e0">&#9670;&nbsp;</a></span>sGate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01164">1164</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits__env__local_8c_source.html#l00104">phaseGate()</a>, and <a class="el" href="qubits_8h_source.html#l00055">S_GATE</a>.</p>
<div class="fragment"><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;{</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                <a class="code" href="qubits_8h.html#ae275b94c1a483dda43bf4ec947635605">phaseGate</a>(multiQubit, rotQubit, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a>);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;} </div><div class="ttc" id="qubits_8h_html_a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f"><div class="ttname"><a href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa06e60f80fa80cce271793d6d31bcc21f">S_GATE</a></div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00055">qubits.h:55</a></div></div>
<div class="ttc" id="qubits_8h_html_ae275b94c1a483dda43bf4ec947635605"><div class="ttname"><a href="qubits_8h.html#ae275b94c1a483dda43bf4ec947635605">phaseGate</a></div><div class="ttdeci">void phaseGate(MultiQubit multiQubit, const int rotQubit, enum phaseGateType type)</div><div class="ttdoc">Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the type argument...</div><div class="ttdef"><b>Definition:</b> <a href="qubits__env__local_8c_source.html#l00104">qubits_env_local.c:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5958808b2f2f05937921ba7dabe5a171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5958808b2f2f05937921ba7dabe5a171">&#9670;&nbsp;</a></span>sigmaXDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaXDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00627">627</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00021">REAL</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00323">sigmaX()</a>.</p>
<div class="fragment"><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;{</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        assert (rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="preprocessor">        shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">        private  (thisTask)</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                        stateVecRealOut[thisTask] = stateVecRealIn[thisTask];</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                        stateVecImagOut[thisTask] = stateVecImagIn[thisTask];</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;} </div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa9e640bb2d0458c937c6a87dfeca0f23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9e640bb2d0458c937c6a87dfeca0f23">&#9670;&nbsp;</a></span>sigmaXLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaXLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00564">564</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00094">sigmaX()</a>.</p>
<div class="fragment"><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;{</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;             indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>&gt;&gt;1;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        assert (rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment">// set dimensions</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        sizeHalfBlock = 1LL &lt;&lt; rotQubit;  </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                        thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                        indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                        indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                        stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                        stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                        stateVecReal[indexUp] = stateVecReal[indexLo];</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                        stateVecImag[indexUp] = stateVecImag[indexLo];</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                        stateVecReal[indexLo] = stateRealUp;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                        stateVecImag[indexLo] = stateImagUp;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                } </div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0471f6b547ce8270ef85170b7f4f0214"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0471f6b547ce8270ef85170b7f4f0214">&#9670;&nbsp;</a></span>sigmaYDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaYDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexArray.html">ComplexArray</a>&#160;</td>
          <td class="paramname"><em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>updateUpper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,-i},{i,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">updateUpper</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00850">850</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, and <a class="el" href="precision_8h_source.html#l00021">REAL</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__mpi_8c_source.html#l00425">sigmaY()</a>.</p>
<div class="fragment"><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;{</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        assert (rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealIn=stateVecIn.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagIn=stateVecIn.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecRealOut=stateVecOut.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>, *stateVecImagOut=stateVecOut.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordtype">int</span> realSign=1, imagSign=1;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">if</span> (updateUpper) imagSign=-1;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordflow">else</span> realSign = -1;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="preprocessor">        shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut,realSign,imagSign) \</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="preprocessor">        private  (thisTask)</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        {</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                        stateVecRealOut[thisTask] = realSign*stateVecImagIn[thisTask];</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                        stateVecImagOut[thisTask] = imagSign*stateVecRealIn[thisTask];</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                }</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        }</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;} </div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afcbb1dcbe070ad0ed1a72a23251b6a83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcbb1dcbe070ad0ed1a72a23251b6a83">&#9670;&nbsp;</a></span>sigmaYLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaYLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,-i},{i,0}. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l00787">787</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits_8h_source.html#l00014">ComplexArray::imag</a>, <a class="el" href="qubits_8h_source.html#l00038">MultiQubit::numAmps</a>, <a class="el" href="qubits_8h_source.html#l00035">MultiQubit::numQubits</a>, <a class="el" href="qubits_8h_source.html#l00013">ComplexArray::real</a>, <a class="el" href="precision_8h_source.html#l00021">REAL</a>, and <a class="el" href="qubits_8h_source.html#l00031">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="qubits__env__local_8c_source.html#l00099">sigmaY()</a>.</p>
<div class="fragment"><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;{</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;             indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateRealUp,stateImagUp;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=multiQubit.<a class="code" href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">numAmps</a>&gt;&gt;1;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="comment">// test qubit valid</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        assert (rotQubit &gt;= 0 &amp;&amp; rotQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="comment">// set dimensions</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        sizeHalfBlock = 1LL &lt;&lt; rotQubit;  </div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        sizeBlock     = 2LL * sizeHalfBlock; </div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="comment">// Can&#39;t use multiQubit.stateVec as a private OMP var</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecReal = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <a class="code" href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateVecImag = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="preprocessor"># pragma omp parallel \</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="preprocessor">        default  (none) \</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="preprocessor">        shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="preprocessor">        private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="preprocessor">                # pragma omp for schedule (static)</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                        thisBlock   = thisTask / sizeHalfBlock;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                        indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                        indexLo     = indexUp + sizeHalfBlock;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                        stateRealUp = stateVecReal[indexUp];</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                        stateImagUp = stateVecImag[indexUp];</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                        stateVecReal[indexUp] = stateVecImag[indexLo];</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                        stateVecImag[indexUp] = -stateVecReal[indexLo];</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                        stateVecReal[indexLo] = -stateImagUp;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                        stateVecImag[indexLo] = stateRealUp;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                } </div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        }</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00013">qubits.h:13</a></div></div>
<div class="ttc" id="precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="precision_8h_source.html#l00021">precision.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00035">qubits.h:35</a></div></div>
<div class="ttc" id="structMultiQubit_html_ae16f47d8b725c914fb7f66b6498d79db"><div class="ttname"><a href="structMultiQubit.html#ae16f47d8b725c914fb7f66b6498d79db">MultiQubit::numAmps</a></div><div class="ttdeci">long long int numAmps</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00038">qubits.h:38</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00014">qubits.h:14</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Probablilty amplitudes for the multi qubit state. </div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00031">qubits.h:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c90f8302e4f1d8fda23def8753e50fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c90f8302e4f1d8fda23def8753e50fe">&#9670;&nbsp;</a></span>sigmaZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{1,0},{{0,-1}} &ndash; apply a phase of -1 to |1&gt;. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rotQubit</td><td>qubit to rotate </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01159">1159</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits__env__local_8c_source.html#l00104">phaseGate()</a>, and <a class="el" href="qubits_8h_source.html#l00055">SIGMA_Z</a>.</p>
<div class="fragment"><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;{</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                <a class="code" href="qubits_8h.html#ae275b94c1a483dda43bf4ec947635605">phaseGate</a>(multiQubit, rotQubit, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a>);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;}</div><div class="ttc" id="qubits_8h_html_a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac"><div class="ttname"><a href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa754922d1e1846a1961ff2bf163483dac">SIGMA_Z</a></div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00055">qubits.h:55</a></div></div>
<div class="ttc" id="qubits_8h_html_ae275b94c1a483dda43bf4ec947635605"><div class="ttname"><a href="qubits_8h.html#ae275b94c1a483dda43bf4ec947635605">phaseGate</a></div><div class="ttdeci">void phaseGate(MultiQubit multiQubit, const int rotQubit, enum phaseGateType type)</div><div class="ttdoc">Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the type argument...</div><div class="ttdef"><b>Definition:</b> <a href="qubits__env__local_8c_source.html#l00104">qubits_env_local.c:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5f33ddd690383fd09cc79bf143e383fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f33ddd690383fd09cc79bf143e383fb">&#9670;&nbsp;</a></span>tGate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rotQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="qubits_8c_source.html#l01169">1169</a> of file <a class="el" href="qubits_8c_source.html">qubits.c</a>.</p>

<p class="reference">References <a class="el" href="qubits__env__local_8c_source.html#l00104">phaseGate()</a>, and <a class="el" href="qubits_8h_source.html#l00055">T_GATE</a>.</p>
<div class="fragment"><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;{</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                <a class="code" href="qubits_8h.html#ae275b94c1a483dda43bf4ec947635605">phaseGate</a>(multiQubit, rotQubit, <a class="code" href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a>);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;}</div><div class="ttc" id="qubits_8h_html_a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab"><div class="ttname"><a href="qubits_8h.html#a5739021c733cecc49647956b2f7338eaa614d07d597a8e320cc556bc0e652e4ab">T_GATE</a></div><div class="ttdef"><b>Definition:</b> <a href="qubits_8h_source.html#l00055">qubits.h:55</a></div></div>
<div class="ttc" id="qubits_8h_html_ae275b94c1a483dda43bf4ec947635605"><div class="ttname"><a href="qubits_8h.html#ae275b94c1a483dda43bf4ec947635605">phaseGate</a></div><div class="ttdeci">void phaseGate(MultiQubit multiQubit, const int rotQubit, enum phaseGateType type)</div><div class="ttdoc">Rotate a single qubit by {{1,0},{0,p}} where p is a phase term determined by the type argument...</div><div class="ttdef"><b>Definition:</b> <a href="qubits__env__local_8c_source.html#l00104">qubits_env_local.c:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 13 2017 18:44:31 for Distributed QUEST by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
