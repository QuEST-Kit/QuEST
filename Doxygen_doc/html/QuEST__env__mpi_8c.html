<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quantum Exact Simulation Toolkit: QuEST_env_mpi.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quantum Exact Simulation Toolkit
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_70834f0dcd10de01d2e35ab402a2238e.html">tysonjones</a></li><li class="navelem"><a class="el" href="dir_1957401ef452be7528010ba0f4832a45.html">Desktop</a></li><li class="navelem"><a class="el" href="dir_e763e4f63987bc6dd0ff21f56afcfed4.html">QuESTRestructured</a></li><li class="navelem"><a class="el" href="dir_b6ad6e9ca9478e43d4c44cdd00457d5f.html">QuEST</a></li><li class="navelem"><a class="el" href="dir_3169c7eb82da2c300108f4c2052f6e4d.html">QuEST</a></li><li class="navelem"><a class="el" href="dir_e97c460c7ba33c252ab3ba7c12a55153.html">CPU</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">QuEST_env_mpi.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>An implementation of the API in qubits.h for an MPI environment.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="QuEST_8h_source.html">../QuEST.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="QuEST__precision_8h_source.html">../QuEST_precision.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mt19937ar_8h_source.html">../mt19937ar.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="CPU_2QuEST__internal_8h_source.html">QuEST_internal.h</a>&quot;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;mpi.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
</div>
<p><a href="QuEST__env__mpi_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad3d8a3bd0c0b677acef144f2c2ef6d73"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#ad3d8a3bd0c0b677acef144f2c2ef6d73">_BSD_SOURCE</a></td></tr>
<tr class="separator:ad3d8a3bd0c0b677acef144f2c2ef6d73"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a818a4c7cd7252d2b10b896b12fa431d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a818a4c7cd7252d2b10b896b12fa431d3">calcTotalProbability</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit)</td></tr>
<tr class="memdesc:a818a4c7cd7252d2b10b896b12fa431d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the probability of being in any state by taking the norm of the entire state vector.  <a href="#a818a4c7cd7252d2b10b896b12fa431d3">More...</a><br /></td></tr>
<tr class="separator:a818a4c7cd7252d2b10b896b12fa431d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0552889d6f57d9e0ed8b209bf426482d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a> (int chunkId, long long int chunkSize, int targetQubit)</td></tr>
<tr class="memdesc:a0552889d6f57d9e0ed8b209bf426482d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether a given chunk in position chunkId is in the upper or lower half of a block.  <a href="#a0552889d6f57d9e0ed8b209bf426482d">More...</a><br /></td></tr>
<tr class="separator:a0552889d6f57d9e0ed8b209bf426482d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd4bc926cd3f9b65610bb228d0c59fe0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#abd4bc926cd3f9b65610bb228d0c59fe0">closeQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr class="memdesc:abd4bc926cd3f9b65610bb228d0c59fe0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close QuEST environment.  <a href="#abd4bc926cd3f9b65610bb228d0c59fe0">More...</a><br /></td></tr>
<tr class="separator:abd4bc926cd3f9b65610bb228d0c59fe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07418ebac70fd9ae5d051d089961631d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a07418ebac70fd9ae5d051d089961631d">collapseToOutcome</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, int outcome)</td></tr>
<tr class="memdesc:a07418ebac70fd9ae5d051d089961631d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the state vector to be consistent with measuring the measure qubit in the given outcome (0 or 1), and returns the probability of such a measurement outcome.  <a href="#a07418ebac70fd9ae5d051d089961631d">More...</a><br /></td></tr>
<tr class="separator:a07418ebac70fd9ae5d051d089961631d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03b13dfcabd8c59b50dbdd3af44ba8b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a03b13dfcabd8c59b50dbdd3af44ba8b2">compactUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="memdesc:a03b13dfcabd8c59b50dbdd3af44ba8b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a single-qubit unitary parameterised by two given complex scalars.  <a href="#a03b13dfcabd8c59b50dbdd3af44ba8b2">More...</a><br /></td></tr>
<tr class="separator:a03b13dfcabd8c59b50dbdd3af44ba8b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4812953bc457405b3aa05a4c2f64f4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#ab4812953bc457405b3aa05a4c2f64f4a">controlledCompactUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="memdesc:ab4812953bc457405b3aa05a4c2f64f4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a controlled unitary (single control, single target) parameterised by two given complex scalars.  <a href="#ab4812953bc457405b3aa05a4c2f64f4a">More...</a><br /></td></tr>
<tr class="separator:ab4812953bc457405b3aa05a4c2f64f4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67576895bbc65463481a8ea24d9b1e22"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a67576895bbc65463481a8ea24d9b1e22">controlledNot</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit)</td></tr>
<tr class="memdesc:a67576895bbc65463481a8ea24d9b1e22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the controlled not (single control, single target) gate, also known as the c-X, c-sigma-X, c-Pauli-X and c-bit-flip gate.  <a href="#a67576895bbc65463481a8ea24d9b1e22">More...</a><br /></td></tr>
<tr class="separator:a67576895bbc65463481a8ea24d9b1e22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a701526263392599aa21d0d0f05d9d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a8a701526263392599aa21d0d0f05d9d8">controlledUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int controlQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="memdesc:a8a701526263392599aa21d0d0f05d9d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a general controlled unitary (single control, single target), which can include a global phase factor.  <a href="#a8a701526263392599aa21d0d0f05d9d8">More...</a><br /></td></tr>
<tr class="separator:a8a701526263392599aa21d0d0f05d9d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7682c9a3fd592d34ec15ba8fa172f104"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int pairRank)</td></tr>
<tr class="separator:a7682c9a3fd592d34ec15ba8fa172f104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f9019826f35e8b51b1716cfe397b45"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#ae5f9019826f35e8b51b1716cfe397b45">exitWithError</a> (int errorCode, const char *func)</td></tr>
<tr class="separator:ae5f9019826f35e8b51b1716cfe397b45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad315c941a51bc053d39ebfa2040fd32e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#ad315c941a51bc053d39ebfa2040fd32e">findProbabilityOfOutcome</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int measureQubit, int outcome)</td></tr>
<tr class="memdesc:ad315c941a51bc053d39ebfa2040fd32e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gives the probability of a specified qubit being measured in the given outcome (0 or 1).  <a href="#ad315c941a51bc053d39ebfa2040fd32e">More...</a><br /></td></tr>
<tr class="separator:ad315c941a51bc053d39ebfa2040fd32e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8605e6a6295174cb4661156eaa709ec4"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a8605e6a6295174cb4661156eaa709ec4">getChunkIdFromIndex</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr class="separator:a8605e6a6295174cb4661156eaa709ec4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dba097f23f5d48dfdc9f3250444e2e4"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a> (int <a class="el" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>, int chunkId, long long int chunkSize, int targetQubit)</td></tr>
<tr class="memdesc:a7dba097f23f5d48dfdc9f3250444e2e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">get position of corresponding chunk, holding values required to update values in my chunk (with chunkId) when rotating targetQubit.  <a href="#a7dba097f23f5d48dfdc9f3250444e2e4">More...</a><br /></td></tr>
<tr class="separator:a7dba097f23f5d48dfdc9f3250444e2e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3615f76fd5f57008d9b74bbd10533dd0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a3615f76fd5f57008d9b74bbd10533dd0">getImagAmpEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr class="memdesc:a3615f76fd5f57008d9b74bbd10533dd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the imaginary component of the complex probability amplitude at an index in the state vector.  <a href="#a3615f76fd5f57008d9b74bbd10533dd0">More...</a><br /></td></tr>
<tr class="separator:a3615f76fd5f57008d9b74bbd10533dd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a317b786f577fa6bc136ea7f0ee7330a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a317b786f577fa6bc136ea7f0ee7330a7">getRealAmpEl</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, long long int index)</td></tr>
<tr class="memdesc:a317b786f577fa6bc136ea7f0ee7330a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the real component of the complex probability amplitude at an index in the state vector.  <a href="#a317b786f577fa6bc136ea7f0ee7330a7">More...</a><br /></td></tr>
<tr class="separator:a317b786f577fa6bc136ea7f0ee7330a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb4b0373425b282abed27742d0ce0872"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#adb4b0373425b282abed27742d0ce0872">getRotAngle</a> (int <a class="el" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>, <a class="el" href="structComplex.html">Complex</a> *rot1, <a class="el" href="structComplex.html">Complex</a> *rot2, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="memdesc:adb4b0373425b282abed27742d0ce0872"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get rotation values for a given chunk.  <a href="#adb4b0373425b282abed27742d0ce0872">More...</a><br /></td></tr>
<tr class="separator:adb4b0373425b282abed27742d0ce0872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c9b2f129bdffaaba9857f6eddecbb17"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a> (int <a class="el" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>, <a class="el" href="structComplex.html">Complex</a> *rot1, <a class="el" href="structComplex.html">Complex</a> *rot2, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="memdesc:a5c9b2f129bdffaaba9857f6eddecbb17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get rotation values for a given chunk given a unitary matrix.  <a href="#a5c9b2f129bdffaaba9857f6eddecbb17">More...</a><br /></td></tr>
<tr class="separator:a5c9b2f129bdffaaba9857f6eddecbb17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa09b5dd93de6df1384b8f2c0041749ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#aa09b5dd93de6df1384b8f2c0041749ab">hadamard</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr class="memdesc:aa09b5dd93de6df1384b8f2c0041749ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the single-qubit Hadamard gate.  <a href="#aa09b5dd93de6df1384b8f2c0041749ab">More...</a><br /></td></tr>
<tr class="separator:aa09b5dd93de6df1384b8f2c0041749ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d043bb0cee54a5f94faf3ffc34a6790"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a> (long long int chunkSize, int targetQubit)</td></tr>
<tr class="memdesc:a4d043bb0cee54a5f94faf3ffc34a6790"><td class="mdescLeft">&#160;</td><td class="mdescRight">return whether the current qubit rotation will use blocks that fit within a single chunk.  <a href="#a4d043bb0cee54a5f94faf3ffc34a6790">More...</a><br /></td></tr>
<tr class="separator:a4d043bb0cee54a5f94faf3ffc34a6790"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad84a3ce68d1ca02b4e3f741ea45b6054"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#ad84a3ce68d1ca02b4e3f741ea45b6054">initQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> *<a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr class="memdesc:ad84a3ce68d1ca02b4e3f741ea45b6054"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the QuEST environment.  <a href="#ad84a3ce68d1ca02b4e3f741ea45b6054">More...</a><br /></td></tr>
<tr class="separator:ad84a3ce68d1ca02b4e3f741ea45b6054"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0ea25f00987af4c53f17c9cca62ab41"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#af0ea25f00987af4c53f17c9cca62ab41">isChunkToSkipInFindPZero</a> (int chunkId, long long int chunkSize, int measureQubit)</td></tr>
<tr class="memdesc:af0ea25f00987af4c53f17c9cca62ab41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find chunks to skip when calculating probability of qubit being zero.  <a href="#af0ea25f00987af4c53f17c9cca62ab41">More...</a><br /></td></tr>
<tr class="separator:af0ea25f00987af4c53f17c9cca62ab41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5774247d836267175c664cd0e451bcb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#ad5774247d836267175c664cd0e451bcb">measure</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int measureQubit)</td></tr>
<tr class="memdesc:ad5774247d836267175c664cd0e451bcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measures a single qubit, collapsing it randomly to 0 or 1.  <a href="#ad5774247d836267175c664cd0e451bcb">More...</a><br /></td></tr>
<tr class="separator:ad5774247d836267175c664cd0e451bcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ac46e470c750bf93c754e06c64b0a7a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a2ac46e470c750bf93c754e06c64b0a7a">measureWithStats</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int measureQubit, <a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *stateProb)</td></tr>
<tr class="memdesc:a2ac46e470c750bf93c754e06c64b0a7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives the probability of that outcome.  <a href="#a2ac46e470c750bf93c754e06c64b0a7a">More...</a><br /></td></tr>
<tr class="separator:a2ac46e470c750bf93c754e06c64b0a7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae395a79690283ed81106afadd7a8cd8a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#ae395a79690283ed81106afadd7a8cd8a">multiControlledUnitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, int *controlQubits, const int numControlQubits, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="memdesc:ae395a79690283ed81106afadd7a8cd8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a general multiple-control single-target unitary, which can include a global phase factor.  <a href="#ae395a79690283ed81106afadd7a8cd8a">More...</a><br /></td></tr>
<tr class="separator:ae395a79690283ed81106afadd7a8cd8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae7a8a7f1ccbddb7f76b6c52b746bb43"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#aae7a8a7f1ccbddb7f76b6c52b746bb43">phaseGate</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a> type)</td></tr>
<tr class="separator:aae7a8a7f1ccbddb7f76b6c52b746bb43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3587b9d533e633ccf1abf9ad2ce45d8d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a> (int isValid, int errorCode, const char *func)</td></tr>
<tr class="separator:a3587b9d533e633ccf1abf9ad2ce45d8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62da5b58d8ce84e6f4d24be1b872294e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a62da5b58d8ce84e6f4d24be1b872294e">reportNodeList</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr class="memdesc:a62da5b58d8ce84e6f4d24be1b872294e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Report a list of CPU hostnames and the rank that is running on each if running with MPI enabled and an error message otherwise.  <a href="#a62da5b58d8ce84e6f4d24be1b872294e">More...</a><br /></td></tr>
<tr class="separator:a62da5b58d8ce84e6f4d24be1b872294e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8a14ae79c3fb2c0b5f6255cc37bebf9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#af8a14ae79c3fb2c0b5f6255cc37bebf9">reportQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr class="memdesc:af8a14ae79c3fb2c0b5f6255cc37bebf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Report information about the QuEST environment.  <a href="#af8a14ae79c3fb2c0b5f6255cc37bebf9">More...</a><br /></td></tr>
<tr class="separator:af8a14ae79c3fb2c0b5f6255cc37bebf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86e396e06b7d527cac20ba0108872423"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a86e396e06b7d527cac20ba0108872423">sigmaX</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr class="memdesc:a86e396e06b7d527cac20ba0108872423"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the single-qubit sigma-X (also known as the X, Pauli-X, NOT or bit-flip) gate.  <a href="#a86e396e06b7d527cac20ba0108872423">More...</a><br /></td></tr>
<tr class="separator:a86e396e06b7d527cac20ba0108872423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f54d70a42403f7e1c2e2c2007332f61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a1f54d70a42403f7e1c2e2c2007332f61">sigmaY</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit)</td></tr>
<tr class="memdesc:a1f54d70a42403f7e1c2e2c2007332f61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the single-qubit sigma-Y (also known as the Y or Pauli-Y) gate.  <a href="#a1f54d70a42403f7e1c2e2c2007332f61">More...</a><br /></td></tr>
<tr class="separator:a1f54d70a42403f7e1c2e2c2007332f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> <a class="el" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>)</td></tr>
<tr class="memdesc:a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Guarantees that all code up to the given point has been executed on all nodes (if running in distributed mode)  <a href="#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">More...</a><br /></td></tr>
<tr class="separator:a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7e38d768a1bd79019f88cc1e6295092"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#ac7e38d768a1bd79019f88cc1e6295092">syncQuESTSuccess</a> (int successCode)</td></tr>
<tr class="memdesc:ac7e38d768a1bd79019f88cc1e6295092"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a logical AND on all successCodes held by all processes.  <a href="#ac7e38d768a1bd79019f88cc1e6295092">More...</a><br /></td></tr>
<tr class="separator:ac7e38d768a1bd79019f88cc1e6295092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a0877e33700f6bad48adb51b7b3fb67"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__env__mpi_8c.html#a7a0877e33700f6bad48adb51b7b3fb67">unitary</a> (<a class="el" href="structMultiQubit.html">MultiQubit</a> multiQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="memdesc:a7a0877e33700f6bad48adb51b7b3fb67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a general single-qubit unitary (including a global phase factor).  <a href="#a7a0877e33700f6bad48adb51b7b3fb67">More...</a><br /></td></tr>
<tr class="separator:a7a0877e33700f6bad48adb51b7b3fb67"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>An implementation of the API in qubits.h for an MPI environment. </p>

<p class="definition">Definition in file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad3d8a3bd0c0b677acef144f2c2ef6d73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3d8a3bd0c0b677acef144f2c2ef6d73">&#9670;&nbsp;</a></span>_BSD_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _BSD_SOURCE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00013">13</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a818a4c7cd7252d2b10b896b12fa431d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a818a4c7cd7252d2b10b896b12fa431d3">&#9670;&nbsp;</a></span>calcTotalProbability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> calcTotalProbability </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the probability of being in any state by taking the norm of the entire state vector. </p>
<p>Should be equal to 1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">multiQubit</td><td>object representing a set of qubits </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>total probability </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00112">112</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST__precision_8h_source.html#l00026">MPI_QuEST_REAL</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00069">MultiQubit::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                                {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// Implemented using Kahan summation for greater accuracy at a slight floating</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">//   point operation overhead. For more details see https://en.wikipedia.org/wiki/Kahan_summation_algorithm</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> pTotal=0; </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> y, t, c;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> allRankTotals=0;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    c = 0.0;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">for</span> (index=0; index&lt;numAmpsPerRank; index++){ </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="comment">// Perform pTotal+=multiQubit.stateVec.real[index]*multiQubit.stateVec.real[index]; by Kahan</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        y = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index]*multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index] - c;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        t = pTotal + y;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="comment">// Don&#39;t change the bracketing on the following line</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        c = ( t - pTotal ) - y;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        pTotal = t;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">// Perform pTotal+=multiQubit.stateVec.imag[index]*multiQubit.stateVec.imag[index]; by Kahan</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        y = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index]*multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index] - c;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        t = pTotal + y;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">// Don&#39;t change the bracketing on the following line</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        c = ( t - pTotal ) - y;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        pTotal = t;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    } </div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">numChunks</a>&gt;1) MPI_Allreduce(&amp;pTotal, &amp;allRankTotals, 1, <a class="code" href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>, MPI_SUM, MPI_COMM_WORLD);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">else</span> allRankTotals=pTotal;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span> allRankTotals;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="structMultiQubit_html_acd43f2f57991709c9e94f73662c972b2"><div class="ttname"><a href="structMultiQubit.html#acd43f2f57991709c9e94f73662c972b2">MultiQubit::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into â€“ the number of MPI processes used...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00069">QuEST.h:69</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a750ad290949ef7dc4afdfbd8231a5057"><div class="ttname"><a href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a></div><div class="ttdeci">#define MPI_QuEST_REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00026">QuEST_precision.h:26</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0552889d6f57d9e0ed8b209bf426482d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0552889d6f57d9e0ed8b209bf426482d">&#9670;&nbsp;</a></span>chunkIsUpper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int chunkIsUpper </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chunkId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>chunkSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns whether a given chunk in position chunkId is in the upper or lower half of a block. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">chunkId</td><td>id of chunk in state vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chunkSize</td><td>number of amps in chunk </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit being rotated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1: chunk is in upper half of block, 0: chunk is in lower half of block fix &ndash; is this the same as isChunkToSkip? </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">150</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00272">compactUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00354">controlledCompactUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00516">controlledNot()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00397">controlledUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00217">getChunkPairId()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00172">getRotAngle()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00197">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00602">hadamard()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00441">multiControlledUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00584">phaseGate()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00487">sigmaX()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00553">sigmaY()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00312">unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{       </div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeHalfBlock = 1LL &lt;&lt; (targetQubit);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock = sizeHalfBlock*2;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> posInBlock = (chunkId*chunkSize) % sizeBlock;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">return</span> posInBlock&lt;sizeHalfBlock;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="abd4bc926cd3f9b65610bb228d0c59fe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd4bc926cd3f9b65610bb228d0c59fe0">&#9670;&nbsp;</a></span>closeQuESTEnv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void closeQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close QuEST environment. </p>
<p>If something needs to be done to clean up the execution environment, such as finalizing MPI when running in distributed mode, it is handled here</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00060">60</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">int</span> finalized;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    MPI_Finalized(&amp;finalized);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (!finalized) MPI_Finalize();</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;ERROR: Trying to close QuESTEnv multiple times. Ignoring\n&quot;</span>);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a07418ebac70fd9ae5d051d089961631d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07418ebac70fd9ae5d051d089961631d">&#9670;&nbsp;</a></span>collapseToOutcome()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> collapseToOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the state vector to be consistent with measuring the measure qubit in the given outcome (0 or 1), and returns the probability of such a measurement outcome. </p>
<p>This is effectively performing a measurement and forcing the outcome. This is an irreversible change to the state vector, whereby incompatible states in the state vector are given zero amplitude and the remaining states are renormalised. Exits with error if the given outcome has ~zero probability, and so cannot be collapsed into.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">outcome</td><td>to force the measure qubit to enter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>probability of the (forced) measurement outcome </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>measureQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or if <code>outcome</code> is not in {0, 1}, or if the probability of <code>outcome</code> is zero (within machine epsilon) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00678">678</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01917">collapseToOutcomeDistributedRenorm()</a>, <a class="el" href="QuEST_8c_source.html#l01957">collapseToOutcomeDistributedSetZero()</a>, <a class="el" href="QuEST_8c_source.html#l01835">collapseToOutcomeLocal()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00659">findProbabilityOfOutcome()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00650">isChunkToSkipInFindPZero()</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00028">REAL_EPS</a>.</p>
<div class="fragment"><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;{</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 2, __func__);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>((outcome==0 || outcome==1), 10, __func__);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> totalStateProb=<a class="code" href="QuEST__env__mpi_8c.html#ad315c941a51bc053d39ebfa2040fd32e">findProbabilityOfOutcome</a>(multiQubit, measureQubit, outcome);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(fabs(totalStateProb)&gt;<a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a>, 8, __func__);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordtype">int</span> skipValuesWithinRank = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, measureQubit);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">if</span> (skipValuesWithinRank) {</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <a class="code" href="QuEST_8c.html#a01d9a8b7ff0e09ec399e158389783aa9">collapseToOutcomeLocal</a>(multiQubit, measureQubit, totalStateProb, outcome);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="QuEST__env__mpi_8c.html#af0ea25f00987af4c53f17c9cca62ab41">isChunkToSkipInFindPZero</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, measureQubit)){</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="comment">// chunk has amps for q=0</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="keywordflow">if</span> (outcome==0) <a class="code" href="QuEST_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db">collapseToOutcomeDistributedRenorm</a>(multiQubit, measureQubit, </div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    totalStateProb);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <span class="keywordflow">else</span> <a class="code" href="QuEST_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1">collapseToOutcomeDistributedSetZero</a>(multiQubit, measureQubit);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="comment">// chunk has amps for q=1</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="keywordflow">if</span> (outcome==1) <a class="code" href="QuEST_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db">collapseToOutcomeDistributedRenorm</a>(multiQubit, measureQubit, </div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    totalStateProb);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <span class="keywordflow">else</span> <a class="code" href="QuEST_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1">collapseToOutcomeDistributedSetZero</a>(multiQubit, measureQubit);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">return</span> totalStateProb;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;}</div><div class="ttc" id="QuEST_8c_html_a01d9a8b7ff0e09ec399e158389783aa9"><div class="ttname"><a href="QuEST_8c.html#a01d9a8b7ff0e09ec399e158389783aa9">collapseToOutcomeLocal</a></div><div class="ttdeci">void collapseToOutcomeLocal(MultiQubit multiQubit, int measureQubit, REAL totalProbability, int outcome)</div><div class="ttdoc">Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01835">QuEST.c:1835</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST_8c_html_a7a1f63ec3c42d9ad72f1f01c14a885db"><div class="ttname"><a href="QuEST_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db">collapseToOutcomeDistributedRenorm</a></div><div class="ttdeci">REAL collapseToOutcomeDistributedRenorm(MultiQubit multiQubit, const int measureQubit, const REAL totalProbability)</div><div class="ttdoc">Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of th...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01917">QuEST.c:1917</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_ad315c941a51bc053d39ebfa2040fd32e"><div class="ttname"><a href="QuEST__env__mpi_8c.html#ad315c941a51bc053d39ebfa2040fd32e">findProbabilityOfOutcome</a></div><div class="ttdeci">REAL findProbabilityOfOutcome(MultiQubit multiQubit, const int measureQubit, int outcome)</div><div class="ttdoc">Gives the probability of a specified qubit being measured in the given outcome (0 or 1)...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00659">QuEST_env_mpi.c:659</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_af0ea25f00987af4c53f17c9cca62ab41"><div class="ttname"><a href="QuEST__env__mpi_8c.html#af0ea25f00987af4c53f17c9cca62ab41">isChunkToSkipInFindPZero</a></div><div class="ttdeci">static int isChunkToSkipInFindPZero(int chunkId, long long int chunkSize, int measureQubit)</div><div class="ttdoc">Find chunks to skip when calculating probability of qubit being zero. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00650">QuEST_env_mpi.c:650</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_aebb5e6716e06431296af4d1a71744dec"><div class="ttname"><a href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a></div><div class="ttdeci">#define REAL_EPS</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00028">QuEST_precision.h:28</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_a78908fe8e75a21fd4f7fa7dff05d6be1"><div class="ttname"><a href="QuEST_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1">collapseToOutcomeDistributedSetZero</a></div><div class="ttdeci">void collapseToOutcomeDistributedSetZero(MultiQubit multiQubit, const int measureQubit)</div><div class="ttdoc">Set all amplitudes in one chunk to 0. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01957">QuEST.c:1957</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a03b13dfcabd8c59b50dbdd3af44ba8b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03b13dfcabd8c59b50dbdd3af44ba8b2">&#9670;&nbsp;</a></span>compactUnitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compactUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a single-qubit unitary parameterised by two given complex scalars. </p>
<p>Given valid complex numbers <img class="formulaInl" alt="$\alpha$" src="form_22.png"/> and <img class="formulaInl" alt="$\beta$" src="form_23.png"/>, applies the unitary </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ U = \begin{pmatrix} \alpha &amp; -\beta^* \\ \beta &amp; \alpha^* \end{pmatrix} \]" src="form_24.png"/>
</p>
<p> which is general up to a global phase factor. <br />
Valid <img class="formulaInl" alt="$\alpha$" src="form_22.png"/>, <img class="formulaInl" alt="$\beta$" src="form_23.png"/> satisfy <img class="formulaInl" alt="$|\alpha|^2 + |\beta|^2 = 1$" src="form_25.png"/>.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_26.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to operate on </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>complex unitary parameter (row 1, column 1) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beta</td><td>complex unitary parameter (row 2, column 1) </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or if <code>alpha</code>, <code>beta</code> don't satisfy |<code>alpha|^2</code> + |<code>beta|^2</code> = 1. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00272">272</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>, <a class="el" href="QuEST_8c_source.html#l00619">compactUnitaryDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l00490">compactUnitaryLocal()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00242">exchangeStateVectors()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00217">getChunkPairId()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00172">getRotAngle()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::pairStateVec</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>, and <a class="el" href="QuEST_8c_source.html#l00415">validateAlphaBeta()</a>.</p>
<div class="fragment"><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;{</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 1, __func__);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="QuEST_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a>(alpha, beta), 6, __func__);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="structComplex.html">Complex</a> rot1, rot2;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="QuEST_8c.html#a9cee2d8716667a3318420a3b672f5b92">compactUnitaryLocal</a>(multiQubit, targetQubit, alpha, beta);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        rankIsUpper = <a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#adb4b0373425b282abed27742d0ce0872">getRotAngle</a>(rankIsUpper, &amp;rot1, &amp;rot2, alpha, beta);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        pairRank = <a class="code" href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. </span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment">// send values to compactUnitaryDistributed in the correct order</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <a class="code" href="QuEST_8c.html#a20ee1878a63ae6112e8845f4a8787592">compactUnitaryDistributed</a>(multiQubit,targetQubit,rot1,rot2,</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <a class="code" href="QuEST_8c.html#a20ee1878a63ae6112e8845f4a8787592">compactUnitaryDistributed</a>(multiQubit,targetQubit,rot1,rot2,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00217">QuEST_env_mpi.c:217</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST_8c_html_a20ee1878a63ae6112e8845f4a8787592"><div class="ttname"><a href="QuEST_8c.html#a20ee1878a63ae6112e8845f4a8787592">compactUnitaryDistributed</a></div><div class="ttdeci">void compactUnitaryDistributed(MultiQubit multiQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</div><div class="ttdoc">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha ...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00619">QuEST.c:619</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_adb4b0373425b282abed27742d0ce0872"><div class="ttname"><a href="QuEST__env__mpi_8c.html#adb4b0373425b282abed27742d0ce0872">getRotAngle</a></div><div class="ttdeci">static void getRotAngle(int chunkIsUpper, Complex *rot1, Complex *rot2, Complex alpha, Complex beta)</div><div class="ttdoc">Get rotation values for a given chunk. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00172">QuEST_env_mpi.c:172</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a7682c9a3fd592d34ec15ba8fa172f104"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(MultiQubit multiQubit, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00242">QuEST_env_mpi.c:242</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00056">QuEST.h:56</a></div></div>
<div class="ttc" id="QuEST_8c_html_ae2b2c14a07dd7d50ff86032a3ca101d7"><div class="ttname"><a href="QuEST_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a></div><div class="ttdeci">int validateAlphaBeta(Complex alpha, Complex beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00415">QuEST.c:415</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00027">QuEST.h:27</a></div></div>
<div class="ttc" id="QuEST_8c_html_a9cee2d8716667a3318420a3b672f5b92"><div class="ttname"><a href="QuEST_8c.html#a9cee2d8716667a3318420a3b672f5b92">compactUnitaryLocal</a></div><div class="ttdeci">void compactUnitaryLocal(MultiQubit multiQubit, const int targetQubit, Complex alpha, Complex beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00490">QuEST.c:490</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab4812953bc457405b3aa05a4c2f64f4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4812953bc457405b3aa05a4c2f64f4a">&#9670;&nbsp;</a></span>controlledCompactUnitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledCompactUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a controlled unitary (single control, single target) parameterised by two given complex scalars. </p>
<p>Given valid complex numbers <img class="formulaInl" alt="$\alpha$" src="form_22.png"/> and <img class="formulaInl" alt="$\beta$" src="form_23.png"/>, applies the two-qubit unitary </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\ &amp; &amp; \alpha &amp; -\beta^* \\ &amp; &amp; \beta &amp; \alpha^* \end{pmatrix} \]" src="form_41.png"/>
</p>
<p> to the control and target qubits. Valid <img class="formulaInl" alt="$\alpha$" src="form_22.png"/>, <img class="formulaInl" alt="$\beta$" src="form_23.png"/> satisfy <img class="formulaInl" alt="$|\alpha|^2 + |\beta|^2 = 1$" src="form_25.png"/>. The target unitary is general up to a global phase factor. <br />
 </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$U_{\alpha, \beta}$}; \end{tikzpicture} } \]" src="form_42.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>apply the target unitary if this qubit has value 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit on which to apply the target unitary </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>complex unitary parameter (row 1, column 1) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beta</td><td>complex unitary parameter (row 2, column 1) </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal, or if <code>alpha</code>, <code>beta</code> don't satisfy |<code>alpha|^2</code> + |<code>beta|^2</code> = 1. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00354">354</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>, <a class="el" href="QuEST_8c_source.html#l00929">controlledCompactUnitaryDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l00720">controlledCompactUnitaryLocal()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00242">exchangeStateVectors()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00217">getChunkPairId()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00172">getRotAngle()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::pairStateVec</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>, and <a class="el" href="QuEST_8c_source.html#l00415">validateAlphaBeta()</a>.</p>
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;{</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 1, __func__);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit &gt;= 0 &amp;&amp; controlQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 2, __func__);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit != targetQubit, 3, __func__);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="QuEST_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a>(alpha, beta), 6, __func__);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="structComplex.html">Complex</a> rot1, rot2;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <a class="code" href="QuEST_8c.html#afc77657651d52c47403b44b923a098a8">controlledCompactUnitaryLocal</a>(multiQubit, controlQubit, targetQubit, alpha, beta);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        rankIsUpper = <a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#adb4b0373425b282abed27742d0ce0872">getRotAngle</a>(rankIsUpper, &amp;rot1, &amp;rot2, alpha, beta);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        pairRank = <a class="code" href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. send values to controlledCompactUnitaryDistributed</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="comment">// in the correct order</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <a class="code" href="QuEST_8c.html#a717855e835e3161e08c18cdc15325d27">controlledCompactUnitaryDistributed</a>(multiQubit,controlQubit,targetQubit,rot1,rot2,</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <a class="code" href="QuEST_8c.html#a717855e835e3161e08c18cdc15325d27">controlledCompactUnitaryDistributed</a>(multiQubit,controlQubit,targetQubit,rot1,rot2,</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        }</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00217">QuEST_env_mpi.c:217</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_adb4b0373425b282abed27742d0ce0872"><div class="ttname"><a href="QuEST__env__mpi_8c.html#adb4b0373425b282abed27742d0ce0872">getRotAngle</a></div><div class="ttdeci">static void getRotAngle(int chunkIsUpper, Complex *rot1, Complex *rot2, Complex alpha, Complex beta)</div><div class="ttdoc">Get rotation values for a given chunk. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00172">QuEST_env_mpi.c:172</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a7682c9a3fd592d34ec15ba8fa172f104"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(MultiQubit multiQubit, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00242">QuEST_env_mpi.c:242</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="QuEST_8c_html_a717855e835e3161e08c18cdc15325d27"><div class="ttname"><a href="QuEST_8c.html#a717855e835e3161e08c18cdc15325d27">controlledCompactUnitaryDistributed</a></div><div class="ttdeci">void controlledCompactUnitaryDistributed(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</div><div class="ttdoc">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha ...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00929">QuEST.c:929</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00056">QuEST.h:56</a></div></div>
<div class="ttc" id="QuEST_8c_html_ae2b2c14a07dd7d50ff86032a3ca101d7"><div class="ttname"><a href="QuEST_8c.html#ae2b2c14a07dd7d50ff86032a3ca101d7">validateAlphaBeta</a></div><div class="ttdeci">int validateAlphaBeta(Complex alpha, Complex beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00415">QuEST.c:415</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="QuEST_8c_html_afc77657651d52c47403b44b923a098a8"><div class="ttname"><a href="QuEST_8c.html#afc77657651d52c47403b44b923a098a8">controlledCompactUnitaryLocal</a></div><div class="ttdeci">void controlledCompactUnitaryLocal(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00720">QuEST.c:720</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00027">QuEST.h:27</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a67576895bbc65463481a8ea24d9b1e22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67576895bbc65463481a8ea24d9b1e22">&#9670;&nbsp;</a></span>controlledNot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledNot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the controlled not (single control, single target) gate, also known as the c-X, c-sigma-X, c-Pauli-X and c-bit-flip gate. </p>
<p>This applies sigmaX to the target qubit if the control qubit has value 1. This effects the two-qubit unitary </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\\ &amp; &amp; &amp; 1 \\ &amp; &amp; 1 \end{pmatrix} \]" src="form_60.png"/>
</p>
<p> on the control and target qubits.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, -.5); \draw (-2,0) -- (2, 0); \draw (0, 0) circle (.5); \end{tikzpicture} } \]" src="form_61.png"/>
</p>
<p> <br />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>nots the target if this qubit is 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to not </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>), or are equal. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00516">516</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>, <a class="el" href="QuEST_8c_source.html#l01258">controlledNotDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l01193">controlledNotLocal()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00242">exchangeStateVectors()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00217">getChunkPairId()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::pairStateVec</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;{</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 1, __func__);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit &gt;= 0 &amp;&amp; controlQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 2, __func__);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit != targetQubit, 3, __func__);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <a class="code" href="QuEST_8c.html#ad357a43e80e3baf013975b1b70942f4c">controlledNotLocal</a>(multiQubit, controlQubit, targetQubit);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        rankIsUpper = <a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        pairRank = <a class="code" href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. send values to controlledNot</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="comment">// in the correct order</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <a class="code" href="QuEST_8c.html#a05875a70b539a3efb28d027823403f34">controlledNotDistributed</a>(multiQubit,controlQubit,targetQubit,</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//in</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">//out</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <a class="code" href="QuEST_8c.html#a05875a70b539a3efb28d027823403f34">controlledNotDistributed</a>(multiQubit,controlQubit,targetQubit,</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//in</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">//out</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;}</div><div class="ttc" id="QuEST_8c_html_a05875a70b539a3efb28d027823403f34"><div class="ttname"><a href="QuEST_8c.html#a05875a70b539a3efb28d027823403f34">controlledNotDistributed</a></div><div class="ttdeci">void controlledNotDistributed(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)</div><div class="ttdoc">Rotate a single qubit by {{0,1},{1,0}. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01258">QuEST.c:1258</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00217">QuEST_env_mpi.c:217</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST_8c_html_ad357a43e80e3baf013975b1b70942f4c"><div class="ttname"><a href="QuEST_8c.html#ad357a43e80e3baf013975b1b70942f4c">controlledNotLocal</a></div><div class="ttdeci">void controlledNotLocal(MultiQubit multiQubit, const int controlQubit, const int targetQubit)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01193">QuEST.c:1193</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a7682c9a3fd592d34ec15ba8fa172f104"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(MultiQubit multiQubit, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00242">QuEST_env_mpi.c:242</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00056">QuEST.h:56</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a701526263392599aa21d0d0f05d9d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a701526263392599aa21d0d0f05d9d8">&#9670;&nbsp;</a></span>controlledUnitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlledUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a general controlled unitary (single control, single target), which can include a global phase factor. </p>
<p>The given unitary is applied to the target qubit if the control qubit has value 1, effecting the two-qubit unitary </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\ &amp; &amp; u_{00} &amp; u_{01}\\ &amp; &amp; u_{10} &amp; u_{11} \end{pmatrix} \]" src="form_43.png"/>
</p>
<p> on the control and target qubits.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 2) {control}; \node[draw=none] at (-3.5, 0) {target}; \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_44.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>apply unitary if this qubit is 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to operate on </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>single-qubit unitary matrix to apply </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if either <code>controlQubit</code> or <code>targetQubit</code> are outside [0, <code>multiQubit.numQubits</code>) or are equal, or if <code>u</code> is not unitary. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00397">397</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>, <a class="el" href="QuEST_8c_source.html#l00992">controlledUnitaryDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l00850">controlledUnitaryLocal()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00242">exchangeStateVectors()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00217">getChunkPairId()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00197">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::pairStateVec</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>, and <a class="el" href="QuEST_8c_source.html#l00391">validateMatrixIsUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;{</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 1, __func__);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit &gt;= 0 &amp;&amp; controlQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 2, __func__);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(controlQubit != targetQubit, 3, __func__);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="QuEST_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a>(u), 5, __func__);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="structComplex.html">Complex</a> rot1, rot2;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <a class="code" href="QuEST_8c.html#a8a4afcff70195a306c082b8ed8d4e09a">controlledUnitaryLocal</a>(multiQubit, controlQubit, targetQubit, u);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        rankIsUpper = <a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a>(rankIsUpper, &amp;rot1, &amp;rot2, u);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        pairRank = <a class="code" href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. send values to controlledUnitaryDistributed</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="comment">// in the correct order</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <a class="code" href="QuEST_8c.html#a642093063a1f889f61a1311f6d6f2d3f">controlledUnitaryDistributed</a>(multiQubit,controlQubit,targetQubit,rot1,rot2,</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <a class="code" href="QuEST_8c.html#a642093063a1f889f61a1311f6d6f2d3f">controlledUnitaryDistributed</a>(multiQubit,controlQubit,targetQubit,rot1,rot2,</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00217">QuEST_env_mpi.c:217</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a7682c9a3fd592d34ec15ba8fa172f104"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(MultiQubit multiQubit, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00242">QuEST_env_mpi.c:242</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="QuEST_8c_html_a8a4afcff70195a306c082b8ed8d4e09a"><div class="ttname"><a href="QuEST_8c.html#a8a4afcff70195a306c082b8ed8d4e09a">controlledUnitaryLocal</a></div><div class="ttdeci">void controlledUnitaryLocal(MultiQubit multiQubit, const int controlQubit, const int targetQubit, ComplexMatrix2 u)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00850">QuEST.c:850</a></div></div>
<div class="ttc" id="QuEST_8c_html_a642093063a1f889f61a1311f6d6f2d3f"><div class="ttname"><a href="QuEST_8c.html#a642093063a1f889f61a1311f6d6f2d3f">controlledUnitaryDistributed</a></div><div class="ttdeci">void controlledUnitaryDistributed(MultiQubit multiQubit, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</div><div class="ttdoc">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha ...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00992">QuEST.c:992</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00056">QuEST.h:56</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a5c9b2f129bdffaaba9857f6eddecbb17"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a></div><div class="ttdeci">static void getRotAngleFromUnitaryMatrix(int chunkIsUpper, Complex *rot1, Complex *rot2, ComplexMatrix2 u)</div><div class="ttdoc">Get rotation values for a given chunk given a unitary matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00197">QuEST_env_mpi.c:197</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_ae4fea133d1a8f09ff8da03038100adb2"><div class="ttname"><a href="QuEST_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a></div><div class="ttdeci">int validateMatrixIsUnitary(ComplexMatrix2 u)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00391">QuEST.c:391</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00027">QuEST.h:27</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7682c9a3fd592d34ec15ba8fa172f104"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7682c9a3fd592d34ec15ba8fa172f104">&#9670;&nbsp;</a></span>exchangeStateVectors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void exchangeStateVectors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pairRank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00242">242</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST__precision_8h_source.html#l00026">MPI_QuEST_REAL</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::pairStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00272">compactUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00354">controlledCompactUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00516">controlledNot()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00397">controlledUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00602">hadamard()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00441">multiControlledUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00487">sigmaX()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00553">sigmaY()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00312">unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                                              {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// MPI send/receive vars</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">int</span> TAG=100;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    MPI_Status status;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// Multiple messages are required as MPI uses int rather than long long int for count</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// For openmpi, messages are further restricted to 2GB in size -- do this for all cases</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// to be safe</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> maxMessageCount = 1LL&lt;&lt;29;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>)==8) maxMessageCount = (1LL&lt;&lt;28);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>)==16) maxMessageCount = (1LL&lt;&lt;27);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>&lt;maxMessageCount) maxMessageCount = multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordtype">int</span> numMessages = multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>/maxMessageCount;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> offset;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// send my state vector to pairRank&#39;s multiQubit.pairStateVec</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// receive pairRank&#39;s state vector into multiQubit.pairStateVec</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;numMessages; i++){</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        offset = i*maxMessageCount;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        MPI_Sendrecv(&amp;multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[offset], maxMessageCount, <a class="code" href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>, pairRank, TAG,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                &amp;multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[offset], maxMessageCount, <a class="code" href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                pairRank, TAG, MPI_COMM_WORLD, &amp;status);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">//printf(&quot;rank: %d err: %d\n&quot;, multiQubit.rank, err);</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        MPI_Sendrecv(&amp;multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[offset], maxMessageCount, <a class="code" href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>, pairRank, TAG,</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                &amp;multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[offset], maxMessageCount, <a class="code" href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>,</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                pairRank, TAG, MPI_COMM_WORLD, &amp;status);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;}</div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00056">QuEST.h:56</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a750ad290949ef7dc4afdfbd8231a5057"><div class="ttname"><a href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a></div><div class="ttdeci">#define MPI_QuEST_REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00026">QuEST_precision.h:26</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5f9019826f35e8b51b1716cfe397b45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5f9019826f35e8b51b1716cfe397b45">&#9670;&nbsp;</a></span>exitWithError()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void exitWithError </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>errorCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00752">752</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8c_source.html#l00027">errorCodes</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>.</p>
<div class="fragment"><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                                                   {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    printf(<span class="stringliteral">&quot;!!!\n&quot;</span>);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    printf(<span class="stringliteral">&quot;QuEST Error in function %s: %s\n&quot;</span>, func, <a class="code" href="QuEST_8c.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a>[errorCode]);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    printf(<span class="stringliteral">&quot;!!!\n&quot;</span>);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    printf(<span class="stringliteral">&quot;exiting..\n&quot;</span>);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    MPI_Abort(MPI_COMM_WORLD, errorCode);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;}</div><div class="ttc" id="QuEST_8c_html_aac1637696885c75b73a1ecf381cea713"><div class="ttname"><a href="QuEST_8c.html#aac1637696885c75b73a1ecf381cea713">errorCodes</a></div><div class="ttdeci">const char * errorCodes[]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00027">QuEST.c:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad315c941a51bc053d39ebfa2040fd32e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad315c941a51bc053d39ebfa2040fd32e">&#9670;&nbsp;</a></span>findProbabilityOfOutcome()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> findProbabilityOfOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gives the probability of a specified qubit being measured in the given outcome (0 or 1). </p>
<p>This performs no actual measurement and does not change the state of the qubits.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to study </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">outcome</td><td>for which to find the probability of the qubit being measured in </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>probability of qubit measureQubit being measured in the given outcome </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>measureQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or if <code>outcome</code> is not in {0, 1}. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00659">659</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01699">findProbabilityOfZeroDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l01643">findProbabilityOfZeroLocal()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00650">isChunkToSkipInFindPZero()</a>, <a class="el" href="QuEST__precision_8h_source.html#l00026">MPI_QuEST_REAL</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00678">collapseToOutcome()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00712">measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;{</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 2, __func__);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateProb=0, totalStateProb=0;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordtype">int</span> skipValuesWithinRank = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, measureQubit);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">if</span> (skipValuesWithinRank) {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        stateProb = <a class="code" href="QuEST_8c.html#a7c02cd0e1b4eac19771a0525f023249e">findProbabilityOfZeroLocal</a>(multiQubit, measureQubit);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="QuEST__env__mpi_8c.html#af0ea25f00987af4c53f17c9cca62ab41">isChunkToSkipInFindPZero</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, measureQubit)){</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            stateProb = <a class="code" href="QuEST_8c.html#a9ac9bb717a889f09d307eda9f0b65957">findProbabilityOfZeroDistributed</a>(multiQubit, measureQubit);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        } <span class="keywordflow">else</span> stateProb = 0;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    MPI_Allreduce(&amp;stateProb, &amp;totalStateProb, 1, <a class="code" href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>, MPI_SUM, MPI_COMM_WORLD);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">if</span> (outcome==1) totalStateProb = 1.0 - totalStateProb;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">return</span> totalStateProb;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_af0ea25f00987af4c53f17c9cca62ab41"><div class="ttname"><a href="QuEST__env__mpi_8c.html#af0ea25f00987af4c53f17c9cca62ab41">isChunkToSkipInFindPZero</a></div><div class="ttdeci">static int isChunkToSkipInFindPZero(int chunkId, long long int chunkSize, int measureQubit)</div><div class="ttdoc">Find chunks to skip when calculating probability of qubit being zero. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00650">QuEST_env_mpi.c:650</a></div></div>
<div class="ttc" id="QuEST_8c_html_a7c02cd0e1b4eac19771a0525f023249e"><div class="ttname"><a href="QuEST_8c.html#a7c02cd0e1b4eac19771a0525f023249e">findProbabilityOfZeroLocal</a></div><div class="ttdeci">REAL findProbabilityOfZeroLocal(MultiQubit multiQubit, const int measureQubit)</div><div class="ttdoc">Measure the total probability of a specified qubit being in the zero state across all amplitudes in t...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01643">QuEST.c:1643</a></div></div>
<div class="ttc" id="QuEST_8c_html_a9ac9bb717a889f09d307eda9f0b65957"><div class="ttname"><a href="QuEST_8c.html#a9ac9bb717a889f09d307eda9f0b65957">findProbabilityOfZeroDistributed</a></div><div class="ttdeci">REAL findProbabilityOfZeroDistributed(MultiQubit multiQubit, const int measureQubit)</div><div class="ttdoc">Measure the probability of a specified qubit being in the zero state across all amplitudes held in th...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01699">QuEST.c:1699</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a750ad290949ef7dc4afdfbd8231a5057"><div class="ttname"><a href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a></div><div class="ttdeci">#define MPI_QuEST_REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00026">QuEST_precision.h:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8605e6a6295174cb4661156eaa709ec4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8605e6a6295174cb4661156eaa709ec4">&#9670;&nbsp;</a></span>getChunkIdFromIndex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int getChunkIdFromIndex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00088">88</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00102">getImagAmpEl()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00092">getRealAmpEl()</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                                                   {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">return</span> index/multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>; <span class="comment">// this is numAmpsPerChunk</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div><div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7dba097f23f5d48dfdc9f3250444e2e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dba097f23f5d48dfdc9f3250444e2e4">&#9670;&nbsp;</a></span>getChunkPairId()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int getChunkPairId </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chunkIsUpper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chunkId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>chunkSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get position of corresponding chunk, holding values required to update values in my chunk (with chunkId) when rotating targetQubit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">chunkIsUpper</td><td>1: chunk is in upper half of block, 0: chunk is in lower half </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chunkId</td><td>id of chunk in state vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chunkSize</td><td>number of amps in chunk </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit being rotated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>chunkId of chunk required to rotate targetQubit </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00217">217</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00272">compactUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00354">controlledCompactUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00516">controlledNot()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00397">controlledUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00602">hadamard()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00441">multiControlledUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00487">sigmaX()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00553">sigmaY()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00312">unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;{</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeHalfBlock = 1LL &lt;&lt; (targetQubit);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">int</span> chunksPerHalfBlock = sizeHalfBlock/chunkSize;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>){</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">return</span> chunkId + chunksPerHalfBlock;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">return</span> chunkId - chunksPerHalfBlock;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3615f76fd5f57008d9b74bbd10533dd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3615f76fd5f57008d9b74bbd10533dd0">&#9670;&nbsp;</a></span>getImagAmpEl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> getImagAmpEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the imaginary component of the complex probability amplitude at an index in the state vector. </p>
<p>For debugging purposes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">multiQubit</td><td>object representing a set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>imaginary component at that index </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>index</code> is outside [0, <img class="formulaInl" alt="$2^{N}$" src="form_20.png"/>) where <img class="formulaInl" alt="$N = $" src="form_21.png"/> <code>multiQubit.numQubits</code> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00102">102</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00088">getChunkIdFromIndex()</a>, <a class="el" href="QuEST_8h_source.html#l00022">ComplexArray::imag</a>, <a class="el" href="QuEST__precision_8h_source.html#l00026">MPI_QuEST_REAL</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                                             {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">int</span> chunkId = <a class="code" href="QuEST__env__mpi_8c.html#a8605e6a6295174cb4661156eaa709ec4">getChunkIdFromIndex</a>(multiQubit, index);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> el; </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>==chunkId){</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        el = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">imag</a>[index-chunkId*multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>];</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    MPI_Bcast(&amp;el, 1, <a class="code" href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>, chunkId, MPI_COMM_WORLD);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">return</span> el; </div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div><div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a8605e6a6295174cb4661156eaa709ec4"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a8605e6a6295174cb4661156eaa709ec4">getChunkIdFromIndex</a></div><div class="ttdeci">static int getChunkIdFromIndex(MultiQubit multiQubit, long long int index)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00088">QuEST_env_mpi.c:88</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplexArray_html_a79dde47c7ae530c79cebfdf57b225968"><div class="ttname"><a href="structComplexArray.html#a79dde47c7ae530c79cebfdf57b225968">ComplexArray::imag</a></div><div class="ttdeci">REAL * imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00022">QuEST.h:22</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a750ad290949ef7dc4afdfbd8231a5057"><div class="ttname"><a href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a></div><div class="ttdeci">#define MPI_QuEST_REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00026">QuEST_precision.h:26</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a317b786f577fa6bc136ea7f0ee7330a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a317b786f577fa6bc136ea7f0ee7330a7">&#9670;&nbsp;</a></span>getRealAmpEl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> getRealAmpEl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the real component of the complex probability amplitude at an index in the state vector. </p>
<p>For debugging purposes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">multiQubit</td><td>object representing a set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>index in state vector of probability amplitudes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>real component at that index </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>index</code> is outside [0, <img class="formulaInl" alt="$2^{N}$" src="form_20.png"/>) where <img class="formulaInl" alt="$N = $" src="form_21.png"/> <code>multiQubit.numQubits</code> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00092">92</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00088">getChunkIdFromIndex()</a>, <a class="el" href="QuEST__precision_8h_source.html#l00026">MPI_QuEST_REAL</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00021">ComplexArray::real</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                                             {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">int</span> chunkId = <a class="code" href="QuEST__env__mpi_8c.html#a8605e6a6295174cb4661156eaa709ec4">getChunkIdFromIndex</a>(multiQubit, index);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> el; </div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span> (multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>==chunkId){</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        el = multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>.<a class="code" href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">real</a>[index-chunkId*multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>];</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    MPI_Bcast(&amp;el, 1, <a class="code" href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a>, chunkId, MPI_COMM_WORLD);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">return</span> el; </div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;} </div><div class="ttc" id="structComplexArray_html_a4195cac6c784ea1b6271f1c7dba1548a"><div class="ttname"><a href="structComplexArray.html#a4195cac6c784ea1b6271f1c7dba1548a">ComplexArray::real</a></div><div class="ttdeci">REAL * real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00021">QuEST.h:21</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a8605e6a6295174cb4661156eaa709ec4"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a8605e6a6295174cb4661156eaa709ec4">getChunkIdFromIndex</a></div><div class="ttdeci">static int getChunkIdFromIndex(MultiQubit multiQubit, long long int index)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00088">QuEST_env_mpi.c:88</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a750ad290949ef7dc4afdfbd8231a5057"><div class="ttname"><a href="QuEST__precision_8h.html#a750ad290949ef7dc4afdfbd8231a5057">MPI_QuEST_REAL</a></div><div class="ttdeci">#define MPI_QuEST_REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00026">QuEST_precision.h:26</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb4b0373425b282abed27742d0ce0872"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb4b0373425b282abed27742d0ce0872">&#9670;&nbsp;</a></span>getRotAngle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void getRotAngle </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chunkIsUpper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get rotation values for a given chunk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">chunkIsUpper</td><td>1: chunk is in upper half of block, 0: chunk is in lower half</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rot1,rot2</td><td>rotation values to use, allocated for upper/lower such that <pre class="fragment">stateUpper = rot1 * stateUpper + conj(rot2)  * stateLower
</pre> or <pre class="fragment">stateLower = rot1 * stateUpper + conj(rot2)  * stateLower
</pre></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha,beta</td><td>initial rotation values </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00172">172</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>, <a class="el" href="QuEST_8h_source.html#l00030">Complex::imag</a>, and <a class="el" href="QuEST_8h_source.html#l00029">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00272">compactUnitary()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00354">controlledCompactUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>){</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        *rot1=alpha;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        rot2-&gt;<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>=-beta.<a class="code" href="structComplex.html#a479ad939835457595fcca3ca55c06283">real</a>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        rot2-&gt;<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>=-beta.<a class="code" href="structComplex.html#a1151948284b21c0052f203f23ab931d9">imag</a>;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        *rot1=beta;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        *rot2=alpha;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
<div class="ttc" id="structComplex_html_a1151948284b21c0052f203f23ab931d9"><div class="ttname"><a href="structComplex.html#a1151948284b21c0052f203f23ab931d9">Complex::imag</a></div><div class="ttdeci">REAL imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00030">QuEST.h:30</a></div></div>
<div class="ttc" id="structComplex_html_a479ad939835457595fcca3ca55c06283"><div class="ttname"><a href="structComplex.html#a479ad939835457595fcca3ca55c06283">Complex::real</a></div><div class="ttdeci">REAL real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00029">QuEST.h:29</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c9b2f129bdffaaba9857f6eddecbb17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c9b2f129bdffaaba9857f6eddecbb17">&#9670;&nbsp;</a></span>getRotAngleFromUnitaryMatrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void getRotAngleFromUnitaryMatrix </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chunkIsUpper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get rotation values for a given chunk given a unitary matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">chunkIsUpper</td><td>1: chunk is in upper half of block, 0: chunk is in lower half</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rot1,rot2</td><td>rotation values to use, allocated for upper/lower such that <pre class="fragment">stateUpper = rot1 * stateUpper + conj(rot2)  * stateLower
</pre> or <pre class="fragment">stateLower = rot1 * stateUpper + conj(rot2)  * stateLower
</pre> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>unitary matrix operation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00197">197</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>, <a class="el" href="QuEST_8h_source.html#l00037">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00037">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00038">ComplexMatrix2::r1c0</a>, and <a class="el" href="QuEST_8h_source.html#l00038">ComplexMatrix2::r1c1</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00397">controlledUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00441">multiControlledUnitary()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00312">unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;{</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>){</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        *rot1=u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        *rot2=u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        *rot1=u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        *rot2=u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div><div class="ttc" id="structComplexMatrix2_html_a763007c3070802373549ba0350f83c8a"><div class="ttname"><a href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">ComplexMatrix2::r1c1</a></div><div class="ttdeci">Complex r1c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00038">QuEST.h:38</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ae72b4458233b077a636beee1892e81ff"><div class="ttname"><a href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">ComplexMatrix2::r0c0</a></div><div class="ttdeci">Complex r0c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00037">QuEST.h:37</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_ab98282015ed2065e53fbc9638e2583ab"><div class="ttname"><a href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">ComplexMatrix2::r1c0</a></div><div class="ttdeci">Complex r1c0</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00038">QuEST.h:38</a></div></div>
<div class="ttc" id="structComplexMatrix2_html_a0f3932f055a8b05cef361bce25d51172"><div class="ttname"><a href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">ComplexMatrix2::r0c1</a></div><div class="ttdeci">Complex r0c1</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00037">QuEST.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa09b5dd93de6df1384b8f2c0041749ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa09b5dd93de6df1384b8f2c0041749ab">&#9670;&nbsp;</a></span>hadamard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hadamard </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the single-qubit Hadamard gate. </p>
<p>This takes <img class="formulaInl" alt="$|0\rangle$" src="form_54.png"/> to <img class="formulaInl" alt="$|+\rangle$" src="form_55.png"/> and <img class="formulaInl" alt="$|1\rangle$" src="form_56.png"/> to <img class="formulaInl" alt="$|-\rangle$" src="form_57.png"/>, and is equivalent to a rotation of <img class="formulaInl" alt="$\pi$" src="form_47.png"/> around the x-axis then <img class="formulaInl" alt="$\pi/2$" src="form_14.png"/> about the y-axis on the Bloch-sphere. I.e. </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{1}{\sqrt{2}} \begin{pmatrix} 1 &amp; 1 \\ 1 &amp; -1 \end{pmatrix} \]" src="form_58.png"/>
</p>
<p> <br />
 </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {H}; \end{tikzpicture} } \]" src="form_59.png"/>
</p>
<p> <br />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to operate on </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00602">602</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00242">exchangeStateVectors()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00217">getChunkPairId()</a>, <a class="el" href="QuEST_8c_source.html#l01446">hadamardDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l01385">hadamardLocal()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::pairStateVec</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;{</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 1, __func__);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <a class="code" href="QuEST_8c.html#aa9f0718b4dd794a3e1b143e3b153bfc5">hadamardLocal</a>(multiQubit, targetQubit);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        rankIsUpper = <a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        pairRank = <a class="code" href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. send values to hadamardDistributed</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="comment">// in the correct order</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <a class="code" href="QuEST_8c.html#ae6a897066979fc52d977007d959ca09d">hadamardDistributed</a>(multiQubit,targetQubit,</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, rankIsUpper); <span class="comment">//output</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <a class="code" href="QuEST_8c.html#ae6a897066979fc52d977007d959ca09d">hadamardDistributed</a>(multiQubit,targetQubit,</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, rankIsUpper); <span class="comment">//output</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div><div class="ttc" id="QuEST_8c_html_aa9f0718b4dd794a3e1b143e3b153bfc5"><div class="ttname"><a href="QuEST_8c.html#aa9f0718b4dd794a3e1b143e3b153bfc5">hadamardLocal</a></div><div class="ttdeci">void hadamardLocal(MultiQubit multiQubit, const int targetQubit)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01385">QuEST.c:1385</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00217">QuEST_env_mpi.c:217</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a7682c9a3fd592d34ec15ba8fa172f104"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(MultiQubit multiQubit, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00242">QuEST_env_mpi.c:242</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00056">QuEST.h:56</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_ae6a897066979fc52d977007d959ca09d"><div class="ttname"><a href="QuEST_8c.html#ae6a897066979fc52d977007d959ca09d">hadamardDistributed</a></div><div class="ttdeci">void hadamardDistributed(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut, int updateUpper)</div><div class="ttdoc">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01446">QuEST.c:1446</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d043bb0cee54a5f94faf3ffc34a6790"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d043bb0cee54a5f94faf3ffc34a6790">&#9670;&nbsp;</a></span>halfMatrixBlockFitsInChunk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int halfMatrixBlockFitsInChunk </td>
          <td>(</td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>chunkSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>return whether the current qubit rotation will use blocks that fit within a single chunk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">chunkSize</td><td>number of amps in chunk </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit being rotated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1: one chunk fits in one block 0: chunk is larger than block </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">235</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00678">collapseToOutcome()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00272">compactUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00354">controlledCompactUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00516">controlledNot()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00397">controlledUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00659">findProbabilityOfOutcome()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00602">hadamard()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00712">measureWithStats()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00441">multiControlledUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00584">phaseGate()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00487">sigmaX()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00553">sigmaY()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00312">unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;{</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeHalfBlock = 1LL &lt;&lt; (targetQubit);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span> (chunkSize &gt; sizeHalfBlock) <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ad84a3ce68d1ca02b4e3f741ea45b6054"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad84a3ce68d1ca02b4e3f741ea45b6054">&#9670;&nbsp;</a></span>initQuESTEnv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a> *&#160;</td>
          <td class="paramname"><em>env</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the QuEST environment. </p>
<p>If something needs to be done to set up the execution environment, such as initializing MPI when running in distributed mode, it is handled here</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">env</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00033">33</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="runTests_8c_source.html#l00017">env</a>, <a class="el" href="QuEST_8h_source.html#l00078">QuESTEnv::numRanks</a>, <a class="el" href="QuEST_8h_source.html#l00077">QuESTEnv::rank</a>, and <a class="el" href="QuEST_8c_source.html#l01994">seedQuESTDefault()</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                                {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// init MPI environment</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">int</span> rank, numRanks, initialized;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    MPI_Initialized(&amp;initialized);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">if</span> (!initialized){</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        MPI_Init(NULL, NULL);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        MPI_Comm_size(MPI_COMM_WORLD, &amp;numRanks);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>-&gt;<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>=rank;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>-&gt;<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>=numRanks;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;ERROR: Trying to initialize QuESTEnv multiple times. Ignoring\n&quot;</span>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="QuEST_8c.html#ab0ab3ec70938712c26988a6aa51263a0">seedQuESTDefault</a>();</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div><div class="ttc" id="runTests_8c_html_a5fd8ba97fcae3408ae6221dfc3cc1f93"><div class="ttname"><a href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a></div><div class="ttdeci">QuESTEnv env</div><div class="ttdef"><b>Definition:</b> <a href="runTests_8c_source.html#l00017">runTests.c:17</a></div></div>
<div class="ttc" id="structQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00078">QuEST.h:78</a></div></div>
<div class="ttc" id="structQuESTEnv_html_aa648bb336cf8598467cb62db00b9cee8"><div class="ttname"><a href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">QuESTEnv::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00077">QuEST.h:77</a></div></div>
<div class="ttc" id="QuEST_8c_html_ab0ab3ec70938712c26988a6aa51263a0"><div class="ttname"><a href="QuEST_8c.html#ab0ab3ec70938712c26988a6aa51263a0">seedQuESTDefault</a></div><div class="ttdeci">void seedQuESTDefault()</div><div class="ttdoc">Seed the Mersenne Twister used for random number generation in the QuEST environment with an example ...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01994">QuEST.c:1994</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af0ea25f00987af4c53f17c9cca62ab41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0ea25f00987af4c53f17c9cca62ab41">&#9670;&nbsp;</a></span>isChunkToSkipInFindPZero()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int isChunkToSkipInFindPZero </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chunkId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>chunkSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find chunks to skip when calculating probability of qubit being zero. </p>
<p>When calculating probability of a bit q being zero, sum up 2^q values, then skip 2^q values, etc. This function finds if an entire chunk is in the range of values to be skipped</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">chunkId</td><td>id of chunk in state vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chunkSize</td><td>number of amps in chunk </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubi</td><td>qubit being measured </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int &ndash; 1: skip, 0: don't skip </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00650">650</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00678">collapseToOutcome()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00659">findProbabilityOfOutcome()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00712">measureWithStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;{</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeHalfBlock = 1LL &lt;&lt; (measureQubit);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordtype">int</span> numChunksToSkip = sizeHalfBlock/chunkSize;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// calculate probability by summing over numChunksToSkip, then skipping numChunksToSkip, etc</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordtype">int</span> bitToCheck = chunkId &amp; numChunksToSkip;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">return</span> bitToCheck;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ad5774247d836267175c664cd0e451bcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5774247d836267175c664cd0e451bcb">&#9670;&nbsp;</a></span>measure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int measure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measures a single qubit, collapsing it randomly to 0 or 1. </p>
<p>Outcome probabilities are weighted by the state vector, which is irreversibly changed after collapse to be consistent with the outcome.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the measurement outcome, 0 or 1 </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>measureQubit</code> is outside [0, <code>multiQubit.numQubits</code>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00706">706</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__env__mpi_8c_source.html#l00712">measureWithStats()</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>
<div class="fragment"><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                                    {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 2, __func__);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateProb; </div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="QuEST__env__mpi_8c.html#a2ac46e470c750bf93c754e06c64b0a7a">measureWithStats</a>(multiQubit, measureQubit, &amp;stateProb); </div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a2ac46e470c750bf93c754e06c64b0a7a"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a2ac46e470c750bf93c754e06c64b0a7a">measureWithStats</a></div><div class="ttdeci">int measureWithStats(MultiQubit multiQubit, int measureQubit, REAL *stateProb)</div><div class="ttdoc">Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives the probability of ...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00712">QuEST_env_mpi.c:712</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ac46e470c750bf93c754e06c64b0a7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ac46e470c750bf93c754e06c64b0a7a">&#9670;&nbsp;</a></span>measureWithStats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int measureWithStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> *&#160;</td>
          <td class="paramname"><em>stateProb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measures a single qubit, collapsing it randomly to 0 or 1, and additionally gives the probability of that outcome. </p>
<p>Outcome probabilities are weighted by the state vector, which is irreversibly changed after collapse to be consistent with the outcome.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateProb</td><td>a pointer to a REAL which is set to the probability of the occurred outcome </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the measurement outcome, 0 or 1 </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>measureQubit</code> is outside [0, <code>multiQubit.numQubits</code>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00712">712</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST_8c_source.html#l01917">collapseToOutcomeDistributedRenorm()</a>, <a class="el" href="QuEST_8c_source.html#l01957">collapseToOutcomeDistributedSetZero()</a>, <a class="el" href="QuEST_8c_source.html#l01835">collapseToOutcomeLocal()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00659">findProbabilityOfOutcome()</a>, <a class="el" href="mt19937ar_8c_source.html#l00150">genrand_real1()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00650">isChunkToSkipInFindPZero()</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00028">REAL_EPS</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00706">measure()</a>.</p>
<div class="fragment"><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                                                              {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(measureQubit &gt;= 0 &amp;&amp; measureQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 2, __func__);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordtype">int</span> outcome;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// find probability of qubit being in state 1</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a> stateProbInternal = <a class="code" href="QuEST__env__mpi_8c.html#ad315c941a51bc053d39ebfa2040fd32e">findProbabilityOfOutcome</a>(multiQubit, measureQubit, 1);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">// we can&#39;t collapse to a state that has a probability too close to zero</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordflow">if</span> (stateProbInternal&lt;<a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a>) outcome=0;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1-stateProbInternal&lt;<a class="code" href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a>) outcome=1;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="comment">// ok. both P(0) and P(1) are large enough to resolve</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="comment">// generate random float on [0,1]</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordtype">float</span> randNum = <a class="code" href="mt19937ar_8c.html#ac94ab75771800274ed1a2bedeca86f04">genrand_real1</a>();</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keywordflow">if</span> (randNum&lt;=stateProbInternal) outcome = 1;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">else</span> outcome = 0;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    } </div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">if</span> (outcome==0) stateProbInternal = 1-stateProbInternal;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordtype">int</span> skipValuesWithinRank = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, measureQubit);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">if</span> (skipValuesWithinRank) {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <a class="code" href="QuEST_8c.html#a01d9a8b7ff0e09ec399e158389783aa9">collapseToOutcomeLocal</a>(multiQubit, measureQubit, stateProbInternal, outcome);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="QuEST__env__mpi_8c.html#af0ea25f00987af4c53f17c9cca62ab41">isChunkToSkipInFindPZero</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, measureQubit)){</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <span class="comment">// chunk has amps for q=0</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <span class="keywordflow">if</span> (outcome==0) <a class="code" href="QuEST_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db">collapseToOutcomeDistributedRenorm</a>(multiQubit, measureQubit, </div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    stateProbInternal);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <span class="keywordflow">else</span> <a class="code" href="QuEST_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1">collapseToOutcomeDistributedSetZero</a>(multiQubit, measureQubit);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="comment">// chunk has amps for q=1</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            <span class="keywordflow">if</span> (outcome==1) <a class="code" href="QuEST_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db">collapseToOutcomeDistributedRenorm</a>(multiQubit, measureQubit, </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                    stateProbInternal);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="keywordflow">else</span> <a class="code" href="QuEST_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1">collapseToOutcomeDistributedSetZero</a>(multiQubit, measureQubit);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        }</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    *stateProb = stateProbInternal;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">return</span> outcome;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;}</div><div class="ttc" id="QuEST_8c_html_a01d9a8b7ff0e09ec399e158389783aa9"><div class="ttname"><a href="QuEST_8c.html#a01d9a8b7ff0e09ec399e158389783aa9">collapseToOutcomeLocal</a></div><div class="ttdeci">void collapseToOutcomeLocal(MultiQubit multiQubit, int measureQubit, REAL totalProbability, int outcome)</div><div class="ttdoc">Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01835">QuEST.c:1835</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST_8c_html_a7a1f63ec3c42d9ad72f1f01c14a885db"><div class="ttname"><a href="QuEST_8c.html#a7a1f63ec3c42d9ad72f1f01c14a885db">collapseToOutcomeDistributedRenorm</a></div><div class="ttdeci">REAL collapseToOutcomeDistributedRenorm(MultiQubit multiQubit, const int measureQubit, const REAL totalProbability)</div><div class="ttdoc">Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of th...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01917">QuEST.c:1917</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_ad315c941a51bc053d39ebfa2040fd32e"><div class="ttname"><a href="QuEST__env__mpi_8c.html#ad315c941a51bc053d39ebfa2040fd32e">findProbabilityOfOutcome</a></div><div class="ttdeci">REAL findProbabilityOfOutcome(MultiQubit multiQubit, const int measureQubit, int outcome)</div><div class="ttdoc">Gives the probability of a specified qubit being measured in the given outcome (0 or 1)...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00659">QuEST_env_mpi.c:659</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_af0ea25f00987af4c53f17c9cca62ab41"><div class="ttname"><a href="QuEST__env__mpi_8c.html#af0ea25f00987af4c53f17c9cca62ab41">isChunkToSkipInFindPZero</a></div><div class="ttdeci">static int isChunkToSkipInFindPZero(int chunkId, long long int chunkSize, int measureQubit)</div><div class="ttdoc">Find chunks to skip when calculating probability of qubit being zero. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00650">QuEST_env_mpi.c:650</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_aebb5e6716e06431296af4d1a71744dec"><div class="ttname"><a href="QuEST__precision_8h.html#aebb5e6716e06431296af4d1a71744dec">REAL_EPS</a></div><div class="ttdeci">#define REAL_EPS</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00028">QuEST_precision.h:28</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_a78908fe8e75a21fd4f7fa7dff05d6be1"><div class="ttname"><a href="QuEST_8c.html#a78908fe8e75a21fd4f7fa7dff05d6be1">collapseToOutcomeDistributedSetZero</a></div><div class="ttdeci">void collapseToOutcomeDistributedSetZero(MultiQubit multiQubit, const int measureQubit)</div><div class="ttdoc">Set all amplitudes in one chunk to 0. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01957">QuEST.c:1957</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="mt19937ar_8c_html_ac94ab75771800274ed1a2bedeca86f04"><div class="ttname"><a href="mt19937ar_8c.html#ac94ab75771800274ed1a2bedeca86f04">genrand_real1</a></div><div class="ttdeci">double genrand_real1(void)</div><div class="ttdef"><b>Definition:</b> <a href="mt19937ar_8c_source.html#l00150">mt19937ar.c:150</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae395a79690283ed81106afadd7a8cd8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae395a79690283ed81106afadd7a8cd8a">&#9670;&nbsp;</a></span>multiControlledUnitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiControlledUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>numControlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a general multiple-control single-target unitary, which can include a global phase factor. </p>
<p>Any number of control qubits can be specified, and if all have value 1, the given unitary is applied to the target qubit. This effects the many-qubit unitary </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 1 \\ &amp; 1 \\\ &amp; &amp; \ddots \\ &amp; &amp; &amp; u_{00} &amp; u_{01}\\ &amp; &amp; &amp; u_{10} &amp; u_{11} \end{pmatrix} \]" src="form_45.png"/>
</p>
<p> on the control and target qubits. The given 2x2 ComplexMatrix must be unitary, otherwise an error is thrown.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 3) {controls}; \node[draw=none] at (-3.5, 0) {target}; \node[draw=none] at (0, 6) {$\vdots$}; \draw (0, 5) -- (0, 4); \draw (-2, 4) -- (2, 4); \draw[fill=black] (0, 4) circle (.2); \draw (0, 4) -- (0, 2); \draw (-2, 2) -- (2, 2); \draw[fill=black] (0, 2) circle (.2); \draw (0, 2) -- (0, 1); \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_46.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubits</td><td>applies unitary if all qubits in this array equal 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numControlQubits</td><td>number of control qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to operate on </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>single-qubit unitary matrix to apply </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>numControlQubits</code> is outside [1, <code>multiQubit.numQubits</code>]), or if any qubit index (<code>targetQubit</code> or one in <code>controlQubits</code>) is outside [0, <code>multiQubit.numQubits</code>]), or if <code>controlQubits</code> contains <code>targetQubit</code>, or if <code>u</code> is not unitary. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00441">441</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00242">exchangeStateVectors()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00217">getChunkPairId()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00197">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8c_source.html#l01056">multiControlledUnitaryDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l00787">multiControlledUnitaryLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::pairStateVec</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>, and <a class="el" href="QuEST_8c_source.html#l00391">validateMatrixIsUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;{</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 1, __func__);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(numControlQubits &gt; 0 &amp;&amp; numControlQubits &lt;= multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 4, __func__);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="QuEST_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a>(u), 5, __func__);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) mask = mask | (1LL&lt;&lt;controlQubits[i]);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(mask &gt;=0 &amp;&amp; mask &lt;= (1LL&lt;&lt;multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>)-1, 2, __func__);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>((mask &amp; (1LL&lt;&lt;targetQubit)) != (1LL&lt;&lt;targetQubit), 3, __func__);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="structComplex.html">Complex</a> rot1, rot2;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <a class="code" href="QuEST_8c.html#a1309eabcba3cb97fbc3cd2e606d17766">multiControlledUnitaryLocal</a>(multiQubit, targetQubit, mask, u);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        rankIsUpper = <a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a>(rankIsUpper, &amp;rot1, &amp;rot2, u);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        pairRank = <a class="code" href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. send values to multiControlledUnitaryDistributed</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="comment">// in the correct order</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <a class="code" href="QuEST_8c.html#a9dbf856ebeea0cf0a3ee5aae6782f2d2">multiControlledUnitaryDistributed</a>(multiQubit,targetQubit,mask,rot1,rot2,</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <a class="code" href="QuEST_8c.html#a9dbf856ebeea0cf0a3ee5aae6782f2d2">multiControlledUnitaryDistributed</a>(multiQubit,targetQubit,mask,rot1,rot2,</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        }</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    }</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00217">QuEST_env_mpi.c:217</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a7682c9a3fd592d34ec15ba8fa172f104"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(MultiQubit multiQubit, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00242">QuEST_env_mpi.c:242</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00056">QuEST.h:56</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a5c9b2f129bdffaaba9857f6eddecbb17"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a></div><div class="ttdeci">static void getRotAngleFromUnitaryMatrix(int chunkIsUpper, Complex *rot1, Complex *rot2, ComplexMatrix2 u)</div><div class="ttdoc">Get rotation values for a given chunk given a unitary matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00197">QuEST_env_mpi.c:197</a></div></div>
<div class="ttc" id="QuEST_8c_html_a9dbf856ebeea0cf0a3ee5aae6782f2d2"><div class="ttname"><a href="QuEST_8c.html#a9dbf856ebeea0cf0a3ee5aae6782f2d2">multiControlledUnitaryDistributed</a></div><div class="ttdeci">void multiControlledUnitaryDistributed(MultiQubit multiQubit, const int targetQubit, long long int mask, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</div><div class="ttdoc">Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01056">QuEST.c:1056</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_ae4fea133d1a8f09ff8da03038100adb2"><div class="ttname"><a href="QuEST_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a></div><div class="ttdeci">int validateMatrixIsUnitary(ComplexMatrix2 u)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00391">QuEST.c:391</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00027">QuEST.h:27</a></div></div>
<div class="ttc" id="QuEST_8c_html_a1309eabcba3cb97fbc3cd2e606d17766"><div class="ttname"><a href="QuEST_8c.html#a1309eabcba3cb97fbc3cd2e606d17766">multiControlledUnitaryLocal</a></div><div class="ttdeci">void multiControlledUnitaryLocal(MultiQubit multiQubit, const int targetQubit, long long int mask, ComplexMatrix2 u)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00787">QuEST.c:787</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae7a8a7f1ccbddb7f76b6c52b746bb43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae7a8a7f1ccbddb7f76b6c52b746bb43">&#9670;&nbsp;</a></span>phaseGate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phaseGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="QuEST_8h.html#a5739021c733cecc49647956b2f7338ea">phaseGateType</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00584">584</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST_8c_source.html#l01568">phaseGateDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l01492">phaseGateLocal()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>.</p>
<div class="fragment"><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;{</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 1, __func__);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <a class="code" href="QuEST_8c.html#a3a54566b73ac84c312d7da4f56ffbc3b">phaseGateLocal</a>(multiQubit, targetQubit, type);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        rankIsUpper = <a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">if</span> (!rankIsUpper) <a class="code" href="QuEST_8c.html#af832ed00b02a0597b7fe0b714032c54a">phaseGateDistributed</a>(multiQubit, targetQubit, type);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="QuEST_8c_html_af832ed00b02a0597b7fe0b714032c54a"><div class="ttname"><a href="QuEST_8c.html#af832ed00b02a0597b7fe0b714032c54a">phaseGateDistributed</a></div><div class="ttdeci">void phaseGateDistributed(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01568">QuEST.c:1568</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="QuEST_8c_html_a3a54566b73ac84c312d7da4f56ffbc3b"><div class="ttname"><a href="QuEST_8c.html#a3a54566b73ac84c312d7da4f56ffbc3b">phaseGateLocal</a></div><div class="ttdeci">void phaseGateLocal(MultiQubit multiQubit, const int targetQubit, enum phaseGateType type)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01492">QuEST.c:1492</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3587b9d533e633ccf1abf9ad2ce45d8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3587b9d533e633ccf1abf9ad2ce45d8d">&#9670;&nbsp;</a></span>QuESTAssert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QuESTAssert </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isValid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>errorCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">760</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST__env__mpi_8c_source.html#l00752">exitWithError()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__env__mpi_8c_source.html#l00678">collapseToOutcome()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00272">compactUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00354">controlledCompactUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00516">controlledNot()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00397">controlledUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00659">findProbabilityOfOutcome()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00602">hadamard()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00706">measure()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00712">measureWithStats()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00441">multiControlledUnitary()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00584">phaseGate()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00487">sigmaX()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00553">sigmaY()</a>, and <a class="el" href="QuEST__env__mpi_8c_source.html#l00312">unitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                                              {</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">if</span> (!isValid) <a class="code" href="QuEST__env__mpi_8c.html#ae5f9019826f35e8b51b1716cfe397b45">exitWithError</a>(errorCode, func);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_ae5f9019826f35e8b51b1716cfe397b45"><div class="ttname"><a href="QuEST__env__mpi_8c.html#ae5f9019826f35e8b51b1716cfe397b45">exitWithError</a></div><div class="ttdeci">void exitWithError(int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00752">QuEST_env_mpi.c:752</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a62da5b58d8ce84e6f4d24be1b872294e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62da5b58d8ce84e6f4d24be1b872294e">&#9670;&nbsp;</a></span>reportNodeList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportNodeList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Report a list of CPU hostnames and the rank that is running on each if running with MPI enabled and an error message otherwise. </p>
<p>For debugging purposes. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00082">82</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="runTests_8c_source.html#l00017">env</a>, and <a class="el" href="QuEST_8h_source.html#l00077">QuESTEnv::rank</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                 {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">char</span> hostName[256];</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    gethostname(hostName, 255);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    printf(<span class="stringliteral">&quot;hostname on rank %d: %s\n&quot;</span>, <a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>.<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>, hostName);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div><div class="ttc" id="runTests_8c_html_a5fd8ba97fcae3408ae6221dfc3cc1f93"><div class="ttname"><a href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a></div><div class="ttdeci">QuESTEnv env</div><div class="ttdef"><b>Definition:</b> <a href="runTests_8c_source.html#l00017">runTests.c:17</a></div></div>
<div class="ttc" id="structQuESTEnv_html_aa648bb336cf8598467cb62db00b9cee8"><div class="ttname"><a href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">QuESTEnv::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00077">QuEST.h:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af8a14ae79c3fb2c0b5f6255cc37bebf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8a14ae79c3fb2c0b5f6255cc37bebf9">&#9670;&nbsp;</a></span>reportQuESTEnv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reportQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Report information about the QuEST environment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00067">67</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="runTests_8c_source.html#l00017">env</a>, <a class="el" href="QuEST_8h_source.html#l00078">QuESTEnv::numRanks</a>, <a class="el" href="QuEST_8h_source.html#l00077">QuESTEnv::rank</a>, and <a class="el" href="QuEST__precision_8h_source.html#l00025">REAL</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                 {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>.<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>==0){</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        printf(<span class="stringliteral">&quot;EXECUTION ENVIRONMENT:\n&quot;</span>); </div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        printf(<span class="stringliteral">&quot;Running distributed (MPI) version\n&quot;</span>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        printf(<span class="stringliteral">&quot;Number of ranks is %d\n&quot;</span>, <a class="code" href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a>.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor"># ifdef _OPENMP</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        printf(<span class="stringliteral">&quot;OpenMP enabled\n&quot;</span>);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        printf(<span class="stringliteral">&quot;Number of threads available is %d\n&quot;</span>, omp_get_max_threads());</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor"># else</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        printf(<span class="stringliteral">&quot;OpenMP disabled\n&quot;</span>);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor"># endif </span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        printf(<span class="stringliteral">&quot;Precision: size of REAL is %ld bytes\n&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a>));</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div><div class="ttc" id="runTests_8c_html_a5fd8ba97fcae3408ae6221dfc3cc1f93"><div class="ttname"><a href="runTests_8c.html#a5fd8ba97fcae3408ae6221dfc3cc1f93">env</a></div><div class="ttdeci">QuESTEnv env</div><div class="ttdef"><b>Definition:</b> <a href="runTests_8c_source.html#l00017">runTests.c:17</a></div></div>
<div class="ttc" id="structQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00078">QuEST.h:78</a></div></div>
<div class="ttc" id="QuEST__precision_8h_html_a4b654506f18b8bfd61ad2a29a7e38c25"><div class="ttname"><a href="QuEST__precision_8h.html#a4b654506f18b8bfd61ad2a29a7e38c25">REAL</a></div><div class="ttdeci">#define REAL</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00025">QuEST_precision.h:25</a></div></div>
<div class="ttc" id="structQuESTEnv_html_aa648bb336cf8598467cb62db00b9cee8"><div class="ttname"><a href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">QuESTEnv::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00077">QuEST.h:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a86e396e06b7d527cac20ba0108872423"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86e396e06b7d527cac20ba0108872423">&#9670;&nbsp;</a></span>sigmaX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the single-qubit sigma-X (also known as the X, Pauli-X, NOT or bit-flip) gate. </p>
<p>This is a rotation of <img class="formulaInl" alt="$\pi$" src="form_47.png"/> around the x-axis on the Bloch sphere. I.e. </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \end{pmatrix} \]" src="form_48.png"/>
</p>
<p> <br />
 </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (2, 0); \draw (0, 0) circle (.5); \draw (0, .5) -- (0, -.5); \end{tikzpicture} } \]" src="form_49.png"/>
</p>
<p> <br />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to operate on </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00487">487</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00242">exchangeStateVectors()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00217">getChunkPairId()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::pairStateVec</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, <a class="el" href="QuEST_8c_source.html#l01165">sigmaXDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l01106">sigmaXLocal()</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;{</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 1, __func__);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <a class="code" href="QuEST_8c.html#a74822fd86bb5d81766e6e8dbdcd62df1">sigmaXLocal</a>(multiQubit, targetQubit);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        rankIsUpper = <a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        pairRank = <a class="code" href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. sigmaX just replaces</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="comment">// this rank&#39;s values with pair values</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <a class="code" href="QuEST_8c.html#a2275fff50824fe47485890ff5a857785">sigmaXDistributed</a>(multiQubit, targetQubit,</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">// in</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">// out</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00217">QuEST_env_mpi.c:217</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="QuEST_8c_html_a2275fff50824fe47485890ff5a857785"><div class="ttname"><a href="QuEST_8c.html#a2275fff50824fe47485890ff5a857785">sigmaXDistributed</a></div><div class="ttdeci">void sigmaXDistributed(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)</div><div class="ttdoc">Rotate a single qubit by {{0,1},{1,0}. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01165">QuEST.c:1165</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a7682c9a3fd592d34ec15ba8fa172f104"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(MultiQubit multiQubit, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00242">QuEST_env_mpi.c:242</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="QuEST_8c_html_a74822fd86bb5d81766e6e8dbdcd62df1"><div class="ttname"><a href="QuEST_8c.html#a74822fd86bb5d81766e6e8dbdcd62df1">sigmaXLocal</a></div><div class="ttdeci">void sigmaXLocal(MultiQubit multiQubit, const int targetQubit)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01106">QuEST.c:1106</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00056">QuEST.h:56</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1f54d70a42403f7e1c2e2c2007332f61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f54d70a42403f7e1c2e2c2007332f61">&#9670;&nbsp;</a></span>sigmaY()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sigmaY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the single-qubit sigma-Y (also known as the Y or Pauli-Y) gate. </p>
<p>This is a rotation of <img class="formulaInl" alt="$\pi$" src="form_47.png"/> around the Y-axis on the Bloch sphere. I.e. </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{pmatrix} 0 &amp; -i \\ i &amp; 0 \end{pmatrix} \]" src="form_50.png"/>
</p>
<p> <br />
 </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {$\sigma_y$}; \end{tikzpicture} } \]" src="form_51.png"/>
</p>
<p> <br />
 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to operate on </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>). </td></tr>
  </table>
  </dd>
</dl>
<p>fix &ndash; put duplicate code (sigmaX, sigmaY) in seperate function </p>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00553">553</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00242">exchangeStateVectors()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00217">getChunkPairId()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::pairStateVec</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, <a class="el" href="QuEST_8c_source.html#l01352">sigmaYDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l01293">sigmaYLocal()</a>, and <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>.</p>
<div class="fragment"><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;{</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 1, __func__);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <a class="code" href="QuEST_8c.html#a81fbfaed65a742a7dfd622e17652245e">sigmaYLocal</a>(multiQubit, targetQubit);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        rankIsUpper = <a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        pairRank = <a class="code" href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, multiQubit.rank, pairRank);</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. sigmaX just replaces</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="comment">// this rank&#39;s values with pair values</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <a class="code" href="QuEST_8c.html#af5ef5166f00c0572354b4ac53dcf40cf">sigmaYDistributed</a>(multiQubit,targetQubit,</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">// in</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">// out</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                rankIsUpper);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00217">QuEST_env_mpi.c:217</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a7682c9a3fd592d34ec15ba8fa172f104"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(MultiQubit multiQubit, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00242">QuEST_env_mpi.c:242</a></div></div>
<div class="ttc" id="QuEST_8c_html_af5ef5166f00c0572354b4ac53dcf40cf"><div class="ttname"><a href="QuEST_8c.html#af5ef5166f00c0572354b4ac53dcf40cf">sigmaYDistributed</a></div><div class="ttdeci">void sigmaYDistributed(MultiQubit multiQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, int updateUpper)</div><div class="ttdoc">Rotate a single qubit by {{0,-i},{i,0}. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01352">QuEST.c:1352</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="QuEST_8c_html_a81fbfaed65a742a7dfd622e17652245e"><div class="ttname"><a href="QuEST_8c.html#a81fbfaed65a742a7dfd622e17652245e">sigmaYLocal</a></div><div class="ttdeci">void sigmaYLocal(MultiQubit multiQubit, const int targetQubit)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l01293">QuEST.c:1293</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00056">QuEST.h:56</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d31fe2d1ad4d01e2a1f5f6b8bc15b77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77">&#9670;&nbsp;</a></span>syncQuESTEnv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void syncQuESTEnv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Guarantees that all code up to the given point has been executed on all nodes (if running in distributed mode) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00050">50</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                               {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    MPI_Barrier(MPI_COMM_WORLD);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ac7e38d768a1bd79019f88cc1e6295092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7e38d768a1bd79019f88cc1e6295092">&#9670;&nbsp;</a></span>syncQuESTSuccess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int syncQuESTSuccess </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>successCode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a logical AND on all successCodes held by all processes. </p>
<p>If any one process has a zero successCode all processes will return a zero success code.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td>object representing the execution environment. A single instance is used for each program </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">successCode</td><td>1 if process task succeeded, 0 if process task failed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if all processes succeeded, 0 if any one process failed </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00054">54</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                     {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">int</span> totalSuccess;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    MPI_Allreduce(&amp;successCode, &amp;totalSuccess, 1, MPI_INT, MPI_LAND, MPI_COMM_WORLD);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">return</span> totalSuccess;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a7a0877e33700f6bad48adb51b7b3fb67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a0877e33700f6bad48adb51b7b3fb67">&#9670;&nbsp;</a></span>unitary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMultiQubit.html">MultiQubit</a>&#160;</td>
          <td class="paramname"><em>multiQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a general single-qubit unitary (including a global phase factor). </p>
<p>The passed 2x2 ComplexMatrix must be unitary, otherwise an error is thrown.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \setlength{\fboxrule}{0.01pt} \fbox{ \begin{tikzpicture}[scale=.5] \node[draw=none] at (-3.5, 0) {target}; \draw (-2,0) -- (-1, 0); \draw (1, 0) -- (2, 0); \draw (-1,-1)--(-1,1)--(1,1)--(1,-1)--cycle; \node[draw=none] at (0, 0) {U}; \end{tikzpicture} } \]" src="form_26.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">multiQubit</td><td>object representing the set of all qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to operate on </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>unitary matrix to apply </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">exitWithError</td><td>if <code>targetQubit</code> is outside [0, <code>multiQubit.numQubits</code>), or matrix <code>u</code> is not unitary. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__env__mpi_8c_source.html#l00312">312</a> of file <a class="el" href="QuEST__env__mpi_8c_source.html">QuEST_env_mpi.c</a>.</p>

<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00067">MultiQubit::chunkId</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00150">chunkIsUpper()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00242">exchangeStateVectors()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00217">getChunkPairId()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00197">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00235">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00065">MultiQubit::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00062">MultiQubit::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00056">MultiQubit::pairStateVec</a>, <a class="el" href="QuEST__env__mpi_8c_source.html#l00760">QuESTAssert()</a>, <a class="el" href="QuEST_8h_source.html#l00054">MultiQubit::stateVec</a>, <a class="el" href="QuEST_8c_source.html#l00675">unitaryDistributed()</a>, <a class="el" href="QuEST_8c_source.html#l00549">unitaryLocal()</a>, and <a class="el" href="QuEST_8c_source.html#l00391">validateMatrixIsUnitary()</a>.</p>
<div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(targetQubit &gt;= 0 &amp;&amp; targetQubit &lt; multiQubit.<a class="code" href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">numQubits</a>, 1, __func__);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a>(<a class="code" href="QuEST_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a>(u), 5, __func__);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a>(multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="structComplex.html">Complex</a> rot1, rot2;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// rank&#39;s chunk is in upper half of block </span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordtype">int</span> rankIsUpper;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> (useLocalDataOnly){</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment">// all values required to update state vector lie in this rank</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <a class="code" href="QuEST_8c.html#ac134fb45b0a7248c5d15e16eb7139a35">unitaryLocal</a>(multiQubit, targetQubit, u);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="comment">// need to get corresponding chunk of state vector from other rank</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        rankIsUpper = <a class="code" href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a>(multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a>(rankIsUpper, &amp;rot1, &amp;rot2, u);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        pairRank = <a class="code" href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a>(rankIsUpper, multiQubit.<a class="code" href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">chunkId</a>, multiQubit.<a class="code" href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">numAmpsPerChunk</a>, targetQubit);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="comment">// get corresponding values from my pair</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <a class="code" href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a>(multiQubit, pairRank);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="comment">// this rank&#39;s values are either in the upper of lower half of the block. </span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">// send values to compactUnitaryDistributed in the correct order</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">if</span> (rankIsUpper){</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <a class="code" href="QuEST_8c.html#a2343b7240118e89aa615e2c9140b770b">unitaryDistributed</a>(multiQubit,targetQubit,rot1,rot2,</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <a class="code" href="QuEST_8c.html#a2343b7240118e89aa615e2c9140b770b">unitaryDistributed</a>(multiQubit,targetQubit,rot1,rot2,</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">pairStateVec</a>, <span class="comment">//upper</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>, <span class="comment">//lower</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    multiQubit.<a class="code" href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">stateVec</a>); <span class="comment">//output</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div><div class="ttc" id="QuEST__env__mpi_8c_html_a7dba097f23f5d48dfdc9f3250444e2e4"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4">getChunkPairId</a></div><div class="ttdeci">static int getChunkPairId(int chunkIsUpper, int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">get position of corresponding chunk, holding values required to update values in my chunk (with chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00217">QuEST_env_mpi.c:217</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a4d043bb0cee54a5f94faf3ffc34a6790"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790">halfMatrixBlockFitsInChunk</a></div><div class="ttdeci">static int halfMatrixBlockFitsInChunk(long long int chunkSize, int targetQubit)</div><div class="ttdoc">return whether the current qubit rotation will use blocks that fit within a single chunk...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00235">QuEST_env_mpi.c:235</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a3587b9d533e633ccf1abf9ad2ce45d8d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a3587b9d533e633ccf1abf9ad2ce45d8d">QuESTAssert</a></div><div class="ttdeci">void QuESTAssert(int isValid, int errorCode, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00760">QuEST_env_mpi.c:760</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a0552889d6f57d9e0ed8b209bf426482d"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a0552889d6f57d9e0ed8b209bf426482d">chunkIsUpper</a></div><div class="ttdeci">static int chunkIsUpper(int chunkId, long long int chunkSize, int targetQubit)</div><div class="ttdoc">Returns whether a given chunk in position chunkId is in the upper or lower half of a block...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00150">QuEST_env_mpi.c:150</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a7682c9a3fd592d34ec15ba8fa172f104"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a7682c9a3fd592d34ec15ba8fa172f104">exchangeStateVectors</a></div><div class="ttdeci">void exchangeStateVectors(MultiQubit multiQubit, int pairRank)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00242">QuEST_env_mpi.c:242</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab5b9795bdc6fb5855e1974dcbbaeb36f"><div class="ttname"><a href="structMultiQubit.html#ab5b9795bdc6fb5855e1974dcbbaeb36f">MultiQubit::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">Number of qubits in the state. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00062">QuEST.h:62</a></div></div>
<div class="ttc" id="structMultiQubit_html_a76f7db4eab52d2b30f58f973ada809c5"><div class="ttname"><a href="structMultiQubit.html#a76f7db4eab52d2b30f58f973ada809c5">MultiQubit::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00056">QuEST.h:56</a></div></div>
<div class="ttc" id="QuEST__env__mpi_8c_html_a5c9b2f129bdffaaba9857f6eddecbb17"><div class="ttname"><a href="QuEST__env__mpi_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17">getRotAngleFromUnitaryMatrix</a></div><div class="ttdeci">static void getRotAngleFromUnitaryMatrix(int chunkIsUpper, Complex *rot1, Complex *rot2, ComplexMatrix2 u)</div><div class="ttdoc">Get rotation values for a given chunk given a unitary matrix. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST__env__mpi_8c_source.html#l00197">QuEST_env_mpi.c:197</a></div></div>
<div class="ttc" id="QuEST_8c_html_ac134fb45b0a7248c5d15e16eb7139a35"><div class="ttname"><a href="QuEST_8c.html#ac134fb45b0a7248c5d15e16eb7139a35">unitaryLocal</a></div><div class="ttdeci">void unitaryLocal(MultiQubit multiQubit, const int targetQubit, ComplexMatrix2 u)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00549">QuEST.c:549</a></div></div>
<div class="ttc" id="structMultiQubit_html_ab10c88249fa3825d6227ceec01d37e37"><div class="ttname"><a href="structMultiQubit.html#ab10c88249fa3825d6227ceec01d37e37">MultiQubit::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00067">QuEST.h:67</a></div></div>
<div class="ttc" id="QuEST_8c_html_a2343b7240118e89aa615e2c9140b770b"><div class="ttname"><a href="QuEST_8c.html#a2343b7240118e89aa615e2c9140b770b">unitaryDistributed</a></div><div class="ttdeci">void unitaryDistributed(MultiQubit multiQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</div><div class="ttdoc">Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower b...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00675">QuEST.c:675</a></div></div>
<div class="ttc" id="QuEST_8c_html_ae4fea133d1a8f09ff8da03038100adb2"><div class="ttname"><a href="QuEST_8c.html#ae4fea133d1a8f09ff8da03038100adb2">validateMatrixIsUnitary</a></div><div class="ttdeci">int validateMatrixIsUnitary(ComplexMatrix2 u)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8c_source.html#l00391">QuEST.c:391</a></div></div>
<div class="ttc" id="structMultiQubit_html_a1cad83601a78635dd278259c7ed54f18"><div class="ttname"><a href="structMultiQubit.html#a1cad83601a78635dd278259c7ed54f18">MultiQubit::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version, this is the total number of amplitudes. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00065">QuEST.h:65</a></div></div>
<div class="ttc" id="structComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00027">QuEST.h:27</a></div></div>
<div class="ttc" id="structMultiQubit_html_a45483190d6b01ef6b2f98f2bec9ab94f"><div class="ttname"><a href="structMultiQubit.html#a45483190d6b01ef6b2f98f2bec9ab94f">MultiQubit::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version. </div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00054">QuEST.h:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jul 14 2018 18:38:23 for Quantum Exact Simulation Toolkit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
